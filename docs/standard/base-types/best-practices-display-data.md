---
title: Procedimientos recomendados para mostrar y conservar datos con formato en .NET
description: Obtenga información sobre cómo mostrar y conservar datos numéricos y de fecha de manera eficaz en las aplicaciones .NET.
ms.date: 05/01/2019
dev_langs:
- csharp
- vb
ms.openlocfilehash: 1748363089a80538a19e91b1955fe9257de39a4e
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/18/2020
ms.locfileid: "94825148"
---
# <a name="best-practices-for-displaying-and-persisting-formatted-data"></a><span data-ttu-id="fdc4a-103">Procedimientos recomendados para mostrar y conservar datos con formato</span><span class="sxs-lookup"><span data-stu-id="fdc4a-103">Best practices for displaying and persisting formatted data</span></span>

<span data-ttu-id="fdc4a-104">En este artículo se examina cómo se usan para la presentación y el almacenamiento los datos con formato, como los datos numéricos y los datos de fecha y hora.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-104">This article examines how formatted data, such as numeric data and date-and-time data, is handled for display and for storage.</span></span>

<span data-ttu-id="fdc4a-105">Cuando desarrolle con .NET, use el formato dependiente de la referencia cultural para mostrar datos que no son de cadena, como números y fechas, en una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-105">When you develop with .NET, use culture-sensitive formatting to display non-string data, such as numbers and dates, in a user interface.</span></span> <span data-ttu-id="fdc4a-106">Use el formato con la [referencia cultural invariable](xref:System.Globalization.CultureInfo.InvariantCulture) para conservar datos que no son de cadena en forma de cadena.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-106">Use formatting with the [invariant culture](xref:System.Globalization.CultureInfo.InvariantCulture) to persist non-string data in string form.</span></span> <span data-ttu-id="fdc4a-107">No use el formato dependiente de la referencia cultural para conservar datos numéricos o datos de fecha y hora en formato de cadena.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-107">Do not use culture-sensitive formatting to persist numeric or date-and-time data in string form.</span></span>

## <a name="displaying-formatted-data"></a><span data-ttu-id="fdc4a-108">Visualización de datos con formato</span><span class="sxs-lookup"><span data-stu-id="fdc4a-108">Displaying formatted data</span></span>

<span data-ttu-id="fdc4a-109">Cuando muestre a los usuarios datos que no sean de cadena, como números, y fechas y horas, asígneles formato mediante la configuración de la referencia cultural del usuario.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-109">When you display non-string data such as numbers and dates and times to users, format them by using the user's cultural settings.</span></span> <span data-ttu-id="fdc4a-110">De forma predeterminada, los siguientes elementos usan la referencia cultural del subproceso actual al dar formato a las operaciones:</span><span class="sxs-lookup"><span data-stu-id="fdc4a-110">By default, the following all use the current thread culture in formatting operations:</span></span>

- <span data-ttu-id="fdc4a-111">Cadenas interpoladas compatibles con los compiladores [C#](../../csharp/language-reference/tokens/interpolated.md) y [Visual Basic](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md).</span><span class="sxs-lookup"><span data-stu-id="fdc4a-111">Interpolated strings supported by the [C#](../../csharp/language-reference/tokens/interpolated.md) and [Visual Basic](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md) compilers.</span></span>
- <span data-ttu-id="fdc4a-112">Operaciones de concatenación de cadenas que usan los operadores de concatenación [C#](../../csharp/language-reference/operators/addition-operator.md#string-concatenation) o [Visual Basic](../../visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md), o que llaman al método <xref:System.String.Concat%2A?displayProperty=nameWithType> directamente.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-112">String concatenation operations that use the [C#](../../csharp/language-reference/operators/addition-operator.md#string-concatenation) or [Visual Basic](../../visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md) concatenation operators or that call the <xref:System.String.Concat%2A?displayProperty=nameWithType> method directly.</span></span>
- <span data-ttu-id="fdc4a-113">El método <xref:System.String.Format%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="fdc4a-113">The <xref:System.String.Format%2A?displayProperty=nameWithType> method.</span></span>
- <span data-ttu-id="fdc4a-114">Métodos `ToString` de los tipos numéricos y tipos de fecha y hora.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-114">The `ToString` methods of the numeric types and the date and time types.</span></span>

<span data-ttu-id="fdc4a-115">Para especificar explícitamente que se debe dar formato a una cadena mediante las convenciones de una referencia cultural nombrada o la [referencia cultural invariable](xref:System.Globalization.CultureInfo.InvariantCulture), se puede hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="fdc4a-115">To explicitly specify that a string should be formatted by using the conventions of a designated culture or the [invariant culture](xref:System.Globalization.CultureInfo.InvariantCulture), you can do the following:</span></span>

- <span data-ttu-id="fdc4a-116">Cuando se usen los métodos <xref:System.String.Format%2A?displayProperty=nameWithType> y `ToString`, llame a una sobrecarga que tenga un parámetro `provider`, como <xref:System.String.Format%28System.IFormatProvider%2CSystem.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> o <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType>, y pásela a la propiedad <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType>, a una instancia <xref:System.Globalization.CultureInfo> que represente la referencia cultural que se quiera o a la propiedad <xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-116">When using the <xref:System.String.Format%2A?displayProperty=nameWithType> and `ToString` methods, call an overload that has a `provider` parameter, such as <xref:System.String.Format%28System.IFormatProvider%2CSystem.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> or <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType>, and pass it the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property, a <xref:System.Globalization.CultureInfo> instance that represents the desired culture, or the <xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="fdc4a-117">Para la concatenación de cadenas, no permita que el compilador realice ninguna de las conversiones implícitas.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-117">For string concatenation, do not allow the compiler to perform any implicit conversions.</span></span> <span data-ttu-id="fdc4a-118">En su lugar, realice una conversión explícita mediante una llamada a una sobrecarga `ToString` que tenga un parámetro `provider`.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-118">Instead, perform an explicit conversion by calling a `ToString` overload that has a `provider` parameter.</span></span> <span data-ttu-id="fdc4a-119">Por ejemplo, el compilador utiliza implícitamente la referencia cultural actual cuando convierte un valor <xref:System.Double> en una cadena en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="fdc4a-119">For example, the compiler implicitly uses the current culture when converting a <xref:System.Double> value to a string in the following code:</span></span>

  [!code-csharp[Implicit String Conversion](./snippets/best-practices-strings/csharp/tostring/Program.cs#1)]
  [!code-vb[Implicit String Conversion](./snippets/best-practices-strings/vb/tostring/Program.vb#1)]

  <span data-ttu-id="fdc4a-120">En su lugar, se puede especificar explícitamente la referencia cultural cuyas convenciones de formato se usan en la conversión mediante una llamada al método <xref:System.Double.ToString(System.IFormatProvider)?displayProperty=nameWithType>, tal como hace el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="fdc4a-120">Instead, you can explicitly specify the culture whose formatting conventions are used in the conversion by calling the <xref:System.Double.ToString(System.IFormatProvider)?displayProperty=nameWithType> method, as the following code does:</span></span>

  [!code-csharp[Explicit String Conversion](./snippets/best-practices-strings/csharp/tostring/Program.cs#2)]
  [!code-vb[Implicit String Conversion](./snippets/best-practices-strings/vb/tostring/Program.vb#2)]

- <span data-ttu-id="fdc4a-121">Para la interpolación de cadenas, en lugar de asignar una cadena interpolada a una instancia <xref:System.String>, asígnela a un elemento <xref:System.FormattableString>.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-121">For string interpolation, rather than assigning an interpolated string to a <xref:System.String> instance, assign it to a <xref:System.FormattableString>.</span></span> <span data-ttu-id="fdc4a-122">Después, se puede llamar al método <xref:System.FormattableString.ToString?displayProperty=nameWithType> para generar una cadena de resultado que refleje las convenciones de la referencia cultural actual, o bien puede llamar al método <xref:System.FormattableString.ToString(System.IFormatProvider)?displayProperty=nameWithType> para generar una cadena de resultado que refleje las convenciones de la referencia cultural especificada.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-122">You can then call its <xref:System.FormattableString.ToString?displayProperty=nameWithType> method produce a result string that reflects the conventions of the current culture, or you can call the <xref:System.FormattableString.ToString(System.IFormatProvider)?displayProperty=nameWithType> method to produce a result string that reflects the conventions of a specified culture.</span></span> <span data-ttu-id="fdc4a-123">También se puede pasar la cadena que admite formato al método estático <xref:System.FormattableString.Invariant%2A?displayProperty=nameWithType> con el fin de generar una cadena de resultado que refleje las convenciones de la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-123">You can also pass the formattable string to the static <xref:System.FormattableString.Invariant%2A?displayProperty=nameWithType> method to produce a result string that reflects the conventions of the invariant culture.</span></span> <span data-ttu-id="fdc4a-124">En el ejemplo siguiente se muestra este enfoque.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-124">The following example illustrates this approach.</span></span> <span data-ttu-id="fdc4a-125">(La salida del ejemplo refleja una referencia cultural actual de en-US).</span><span class="sxs-lookup"><span data-stu-id="fdc4a-125">(The output from the example reflects a current culture of en-US.)</span></span>

  [!code-csharp[String interpolation](./snippets/best-practices-strings/csharp/formattable/Program.cs)]
  [!code-vb[String interpolation](./snippets/best-practices-strings/vb/formattable/Program.vb)]

## <a name="persisting-formatted-data"></a><span data-ttu-id="fdc4a-126">Conservación de datos con formato</span><span class="sxs-lookup"><span data-stu-id="fdc4a-126">Persisting formatted data</span></span>

<span data-ttu-id="fdc4a-127">Puede conservar datos que no son de cadena como datos binarios o como datos con formato.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-127">You can persist non-string data either as binary data or as formatted data.</span></span> <span data-ttu-id="fdc4a-128">Si decide guardarlos como datos con formato, debe llamar a una sobrecarga del método de formato que incluya un parámetro `provider` y pasarle la propiedad <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="fdc4a-128">If you choose to save it as formatted data, you should call a formatting method overload that includes a `provider` parameter and pass it the <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="fdc4a-129">La referencia cultural de todos los idiomas proporciona un formato coherente para los datos con formato que es independiente de la referencia cultural y del equipo.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-129">The invariant culture provides a consistent format for formatted data that is independent of culture and machine.</span></span> <span data-ttu-id="fdc4a-130">En cambio, si se conservan datos a los que se aplica formato con referencias culturales distintas de la referencia cultural de todos los idiomas, se presentan varias limitaciones:</span><span class="sxs-lookup"><span data-stu-id="fdc4a-130">In contrast, persisting data that is formatted by using cultures other than the invariant culture has a number of limitations:</span></span>

- <span data-ttu-id="fdc4a-131">Es probable que los datos no puedan usarse si se recuperan en un sistema que tiene una referencia cultural distinta, o si el usuario del sistema actual cambia la referencia cultural actual e intenta recuperar los datos.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-131">The data is likely to be unusable if it is retrieved on a system that has a different culture, or if the user of the current system changes the current culture and tries to retrieve the data.</span></span>
- <span data-ttu-id="fdc4a-132">Las propiedades de una referencia cultural en un equipo específico pueden diferir de los valores estándar.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-132">The properties of a culture on a specific computer can differ from standard values.</span></span> <span data-ttu-id="fdc4a-133">En cualquier momento, un usuario puede personalizar la configuración de visualización que depende de la cultural.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-133">At any time, a user can customize culture-sensitive display settings.</span></span> <span data-ttu-id="fdc4a-134">Debido a esto, es posible que los datos con formato que se guardan en un sistema no sean legibles después de que el usuario personalice la configuración de la referencia cultural.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-134">Because of this, formatted data that is saved on a system may not be readable after the user customizes cultural settings.</span></span> <span data-ttu-id="fdc4a-135">Es posible que la portabilidad de los datos con formato entre equipos sea incluso más limitada.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-135">The portability of formatted data across computers is likely to be even more limited.</span></span>
- <span data-ttu-id="fdc4a-136">Las normas internacionales, regionales o nacionales que rigen el formato de los números o las fechas y horas cambian con el tiempo, y estos cambios se incorporan en las actualizaciones de los sistemas operativos Windows.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-136">International, regional, or national standards that govern the formatting of numbers or dates and times change over time, and these changes are incorporated into Windows operating system updates.</span></span> <span data-ttu-id="fdc4a-137">Cuando cambian las convenciones de formato, los datos a los que se aplicó formato usando las convenciones anteriores pueden llegar a ser ilegibles.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-137">When formatting conventions change, data that was formatted by using the previous conventions may become unreadable.</span></span>

<span data-ttu-id="fdc4a-138">En el ejemplo siguiente se muestra la portabilidad limitada que se deriva de usar el formato dependiente de la referencia cultural para conservar los datos.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-138">The following example illustrates the limited portability that results from using culture-sensitive formatting to persist data.</span></span> <span data-ttu-id="fdc4a-139">En el ejemplo se guarda una matriz de valores de fecha y hora en un archivo.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-139">The example saves an array of date and time values to a file.</span></span> <span data-ttu-id="fdc4a-140">Se les da formato con las convenciones de la referencia cultural Inglés (Estados Unidos).</span><span class="sxs-lookup"><span data-stu-id="fdc4a-140">These are formatted by using the conventions of the English (United States) culture.</span></span> <span data-ttu-id="fdc4a-141">Después de que la aplicación cambie la referencia cultural del subproceso actual a Francés (Suiza), intenta leer los valores guardados usando las convenciones de formato de la referencia cultural actual.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-141">After the application changes the current thread culture to French (Switzerland), it tries to read the saved values by using the formatting conventions of the current culture.</span></span> <span data-ttu-id="fdc4a-142">El intento de leer dos de los elementos de datos genera una excepción <xref:System.FormatException> y la matriz de fechas ahora contiene dos elementos incorrectos que iguales a <xref:System.DateTime.MinValue>.</span><span class="sxs-lookup"><span data-stu-id="fdc4a-142">The attempt to read two of the data items throws a <xref:System.FormatException> exception, and the array of dates now contains two incorrect elements that are equal to <xref:System.DateTime.MinValue>.</span></span>

[!code-csharp[Conceptual.Strings.BestPractices#21](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.strings.bestpractices/cs/persistence.cs#21)]
[!code-vb[Conceptual.Strings.BestPractices#21](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.strings.bestpractices/vb/persistence.vb#21)]

<span data-ttu-id="fdc4a-143">Pero si reemplaza la propiedad <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> por <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> en las llamadas a <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> y a <xref:System.DateTime.Parse%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType>, los datos persistentes de fecha y hora se restauran correctamente, como se muestra en la salida siguiente:</span><span class="sxs-lookup"><span data-stu-id="fdc4a-143">However, if you replace the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property with <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> in the calls to <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> and <xref:System.DateTime.Parse%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType>, the persisted date and time data is successfully restored, as the following output shows:</span></span>

```console
06.05.1758 21:26
05.05.1818 07:19
22.04.1870 23:54
08.09.1890 06:47
18.02.1905 15:12
```
