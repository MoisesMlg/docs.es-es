---
title: Aplicar atributos de interoperabilidad
description: En este artículo se resumen los atributos de interoperabilidad COM del espacio de nombres System.Runtime.InteropServices, incluidos los atributos de tiempo de diseño y herramienta de conversión.
ms.date: 03/30/2017
helpviewer_keywords:
- design-time attributes
- .NET, exposing components to COM
- attributes [.NET], design-time functionality
- conversion-tool attributes
- attributes [.NET], interop-specific
- attributes [.NET], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
ms.openlocfilehash: 7b9e557e36d2ff6aa978eb28d3c82764ffb1980a
ms.sourcegitcommit: 7588b1f16b7608bc6833c05f91ae670c22ef56f8
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/02/2020
ms.locfileid: "93188684"
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="9e4b7-103">Aplicar atributos de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="9e4b7-103">Applying Interop Attributes</span></span>
<span data-ttu-id="9e4b7-104">El espacio de nombres <xref:System.Runtime.InteropServices> proporciona tres categorías de atributos específicos de interoperabilidad: los que se aplican por parte del usuario en tiempo de diseño, los que se aplican mediante herramientas de interoperabilidad COM y durante el proceso de conversión, y los que se aplican por parte del usuario o interoperabilidad COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-104">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="9e4b7-105">Si no está familiarizado con la tarea de aplicar atributos al código administrado, vea [Extender metadatos mediante atributos](../attributes/index.md).</span><span class="sxs-lookup"><span data-stu-id="9e4b7-105">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../attributes/index.md).</span></span> <span data-ttu-id="9e4b7-106">Al igual que otros atributos personalizados, puede aplicar atributos específicos de interoperabilidad a tipos, métodos, propiedades, parámetros, campos y otros miembros.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-106">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="9e4b7-107">Atributos en tiempo de diseño</span><span class="sxs-lookup"><span data-stu-id="9e4b7-107">Design-Time Attributes</span></span>  
 <span data-ttu-id="9e4b7-108">Puede ajustar el resultado del proceso de conversión realizado por las API y las herramientas de interoperabilidad COM mediante atributos en tiempo de diseño.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-108">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="9e4b7-109">En la tabla siguiente se describen los atributos que se pueden aplicar al código fuente administrado.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-109">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="9e4b7-110">En ocasiones, es posible que las herramientas de interoperabilidad COM también apliquen los atributos descritos en esta tabla.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-110">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="9e4b7-111">Atributo</span><span class="sxs-lookup"><span data-stu-id="9e4b7-111">Attribute</span></span>|<span data-ttu-id="9e4b7-112">Descripción</span><span class="sxs-lookup"><span data-stu-id="9e4b7-112">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="9e4b7-113">Especifica si el tipo debe serializarse mediante el contador de referencias de Automation o un proxy personalizado y código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-113">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="9e4b7-114">Controla el tipo de interfaz generada para una clase.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-114">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="9e4b7-115">Identifica el CLSID de la coclase original importada desde una biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-115">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="9e4b7-116">Las herramientas de interoperabilidad COM aplican normalmente este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-116">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="9e4b7-117">Indica que una definición de interfaz o coclase se importó desde una biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-117">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="9e4b7-118">El tiempo de ejecución usa este indicador para saber cómo activar y serializar el tipo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-118">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="9e4b7-119">Este atributo prohíbe que el tipo se vuelva a exportar a una biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-119">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="9e4b7-120">Las herramientas de interoperabilidad COM aplican normalmente este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-120">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="9e4b7-121">Indica que debe llamarse a un método cuando el ensamblado se registra para su uso desde COM, por lo que se puede ejecutar código escrito por el usuario durante el proceso de registro.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-121">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="9e4b7-122">Identifica las interfaces que son orígenes de eventos para la clase.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-122">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="9e4b7-123">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-123">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="9e4b7-124">Indica que debe llamarse a un método cuando se anula el registro del ensamblado desde COM, para que se pueda ejecutar código escrito por el usuario durante el proceso.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-124">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="9e4b7-125">Representa tipos visibles para COM cuando el valor del atributo es igual a **false**.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-125">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="9e4b7-126">Este atributo se puede aplicar a un tipo individual o a un ensamblado completo para controlar la visibilidad de COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-126">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="9e4b7-127">De forma predeterminada, todos los tipos públicos son visibles; no se necesita el atributo para hacerlos visibles.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-127">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="9e4b7-128">Especifica el identificador de envío (DISPID) de COM de un método o campo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-128">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="9e4b7-129">Este atributo contiene el DISPID para el método, campo o propiedad que describe.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-129">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="9e4b7-130">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-130">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.ComDefaultInterfaceAttribute>|<span data-ttu-id="9e4b7-131">Indica la interfaz predeterminada para una clase COM implementada en .NET.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-131">Indicates the default interface for a COM class implemented in .NET.</span></span><br /><br /> <span data-ttu-id="9e4b7-132">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-132">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="9e4b7-133">Indica la posición física de cada campo dentro de una clase cuando se usa con **StructLayoutAttribute** , y **LayoutKind** se establece en Explicit.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-133">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute** , and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="9e4b7-134">Especifica el identificador único global (GUID) de una clase, interfaz o una biblioteca de tipos completa.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-134">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="9e4b7-135">La cadena que se pasa al atributo debe tener un formato que sea un argumento de constructor aceptable para el tipo de **System.Guid**.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-135">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="9e4b7-136">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-136">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="9e4b7-137">Indica la implementación de la interfaz **IDispatch** que usa el Common Language Runtime cuando expone interfaces duales e interfaces dispinterface a COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-137">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="9e4b7-138">Indica que los datos se deben serializar en el llamador.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-138">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="9e4b7-139">Se puede usar para parámetros de atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-139">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="9e4b7-140">Controla la forma en que se expone una interfaz administrada a los clientes COM (Dual, derivada de IUnknown o solo IDispatch).</span><span class="sxs-lookup"><span data-stu-id="9e4b7-140">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="9e4b7-141">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-141">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="9e4b7-142">Indica que una firma de método no administrado espera un parámetro LCID.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-142">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="9e4b7-143">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-143">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="9e4b7-144">Indica cómo se deben serializar los datos de campos o parámetros entre código administrado y no administrado.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-144">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="9e4b7-145">El atributo siempre es opcional porque cada tipo de datos tiene el comportamiento de serialización predeterminado.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-145">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="9e4b7-146">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-146">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="9e4b7-147">Indica que un parámetro es opcional.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-147">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="9e4b7-148">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-148">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="9e4b7-149">Indica que los datos de un campo o parámetro deben serializarse desde un objeto que se llama a su llamador.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-149">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="9e4b7-150">Suprime la transformación de la firma retval o del valor HRESULT que normalmente tiene lugar durante las llamadas de interoperabilidad.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-150">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="9e4b7-151">El atributo afecta a la serialización, así como a la exportación de bibliotecas de tipos.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-151">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="9e4b7-152">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-152">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="9e4b7-153">Especifica el valor ProgID de una clase de .NET.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-153">Specifies the ProgID of a .NET class.</span></span> <span data-ttu-id="9e4b7-154">Se puede usar para clases de atributos.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-154">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="9e4b7-155">Controla el diseño físico de los campos de una clase.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-155">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="9e4b7-156">Las herramientas de interoperabilidad COM pueden aplicar este atributo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-156">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="9e4b7-157">Atributos de la herramienta de conversión</span><span class="sxs-lookup"><span data-stu-id="9e4b7-157">Conversion-Tool Attributes</span></span>  
 <span data-ttu-id="9e4b7-158">En la tabla siguiente se describen los atributos que las herramientas de interoperabilidad COM aplican durante el proceso de conversión.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-158">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="9e4b7-159">Estos atributos no se aplican en tiempo de diseño.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-159">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="9e4b7-160">Atributo</span><span class="sxs-lookup"><span data-stu-id="9e4b7-160">Attribute</span></span>|<span data-ttu-id="9e4b7-161">Descripción</span><span class="sxs-lookup"><span data-stu-id="9e4b7-161">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="9e4b7-162">Indica el alias COM de un parámetro o tipo de campo.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-162">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="9e4b7-163">Puede usarse para parámetros de atributo, campos o valores devueltos.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-163">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="9e4b7-164">Indica que se perdió la información sobre una clase o interfaz cuando se importó desde una biblioteca de tipos a un ensamblado.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-164">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="9e4b7-165">Identifica la interfaz de origen y la clase que implementa los métodos de la interfaz de eventos.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-165">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="9e4b7-166">Indica que el ensamblado se importó originalmente desde una biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-166">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="9e4b7-167">Este atributo contiene la definición de biblioteca de tipos de la biblioteca de tipos original.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-167">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="9e4b7-168">Contiene los **FUNCFLAGS** que se importaron originalmente para esta función desde la biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-168">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="9e4b7-169">Contiene los **TYPEFLAGS** que se importaron originalmente para este tipo desde la biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-169">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="9e4b7-170">Contiene los **VARFLAGS** que se importaron originalmente para esta variable desde la biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="9e4b7-170">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="9e4b7-171">Vea también</span><span class="sxs-lookup"><span data-stu-id="9e4b7-171">See also</span></span>

- <xref:System.Runtime.InteropServices>
- [<span data-ttu-id="9e4b7-172">Exponer componentes de .NET Framework en COM</span><span class="sxs-lookup"><span data-stu-id="9e4b7-172">Exposing .NET Framework Components to COM</span></span>](../../framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="9e4b7-173">Atributos</span><span class="sxs-lookup"><span data-stu-id="9e4b7-173">Attributes</span></span>](../attributes/index.md)
- [<span data-ttu-id="9e4b7-174">Habilitar tipos de .NET para la interoperación</span><span class="sxs-lookup"><span data-stu-id="9e4b7-174">Qualifying .NET Types for Interoperation</span></span>](qualify-net-types-for-interoperation.md)
- [<span data-ttu-id="9e4b7-175">Empaquetar un ensamblado de .NET Framework para COM</span><span class="sxs-lookup"><span data-stu-id="9e4b7-175">Packaging a .NET Framework Assembly for COM</span></span>](../../framework/interop/packaging-an-assembly-for-com.md)
