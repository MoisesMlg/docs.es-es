---
title: Validación de un documento XML en el DOM
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
ms.assetid: 2c61c920-d0f8-4c72-bfcc-6524570f3060
ms.openlocfilehash: db3748d1d0e1a5687219d5b07d1261639a4ef670
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/18/2020
ms.locfileid: "94819297"
---
# <a name="validating-an-xml-document-in-the-dom"></a><span data-ttu-id="55c18-102">Validación de un documento XML en el DOM</span><span class="sxs-lookup"><span data-stu-id="55c18-102">Validating an XML Document in the DOM</span></span>

<span data-ttu-id="55c18-103">La clase <xref:System.Xml.XmlDocument> no valida el código XML en el Modelo de objetos de documento (DOM) con un esquema del lenguaje de definición de esquemas XML (XSD) ni una definición de tipo de documento (DTD) de manera predeterminada; solo se comprueba si el código XML es correcto.</span><span class="sxs-lookup"><span data-stu-id="55c18-103">The<xref:System.Xml.XmlDocument> class does not validate the XML in the Document Object Model (DOM) against an XML Schema definition language (XSD) schema or document type definition (DTD) by default; the XML is only verified to be well-formed.</span></span>

<span data-ttu-id="55c18-104">Para validar el código XML en el DOM, puede validarlo a medida que se carga en el DOM pasando un <xref:System.Xml.XmlReader> de validación de esquemas al método <xref:System.Xml.XmlDocument.Load%2A> de la clase <xref:System.Xml.XmlDocument>, o bien validar en el DOM un documento XML que no estuviera validado previamente utilizando el método <xref:System.Xml.XmlDocument.Validate%2A> de la clase <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="55c18-104">To validate the XML in the DOM, you can validate the XML as it is loaded into the DOM by passing a schema-validating <xref:System.Xml.XmlReader> to the <xref:System.Xml.XmlDocument.Load%2A> method of the <xref:System.Xml.XmlDocument> class, or validate a previously unvalidated XML document in the DOM using the <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class.</span></span>

## <a name="validating-an-xml-document-as-it-is-loaded-into-the-dom"></a><span data-ttu-id="55c18-105">Validación de un documento XML a medida que se carga en el DOM</span><span class="sxs-lookup"><span data-stu-id="55c18-105">Validating an XML Document As It Is Loaded into the DOM</span></span>

<span data-ttu-id="55c18-106">La clase <xref:System.Xml.XmlDocument> valida los datos XML a medida que se cargan en el DOM cuando se pasa un <xref:System.Xml.XmlReader> de validación al método <xref:System.Xml.XmlDocument.Load%2A> de la clase <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="55c18-106">The <xref:System.Xml.XmlDocument> class validates the XML data as it is loaded into the DOM when a validating <xref:System.Xml.XmlReader> is passed to the <xref:System.Xml.XmlDocument.Load%2A> method of the <xref:System.Xml.XmlDocument> class.</span></span>

<span data-ttu-id="55c18-107">Después de realizar la validación correctamente, se aplican los valores predeterminados del esquema, los valores de texto se convierten en valores atómicos como sea preciso y la información de tipos se asocia a los elementos de información validados.</span><span class="sxs-lookup"><span data-stu-id="55c18-107">After successful validation, schema defaults are applied, text values are converted to atomic values as necessary, and type information is associated with validated information items.</span></span> <span data-ttu-id="55c18-108">Como resultado, los datos XML con tipo reemplazan a los datos XML sin tipo anteriores.</span><span class="sxs-lookup"><span data-stu-id="55c18-108">As a result, typed XML data replaces previously untyped XML data.</span></span>

### <a name="creating-an-xml-schema-validating-xmlreader"></a><span data-ttu-id="55c18-109">Creación de un XmlReader de validación de esquemas XML</span><span class="sxs-lookup"><span data-stu-id="55c18-109">Creating an XML Schema-Validating XmlReader</span></span>

<span data-ttu-id="55c18-110">Para crear un <xref:System.Xml.XmlReader> de validación de esquemas XML, siga estos pasos.</span><span class="sxs-lookup"><span data-stu-id="55c18-110">To create an XML schema-validating <xref:System.Xml.XmlReader>, follow these steps.</span></span>

1. <span data-ttu-id="55c18-111">Cree una nueva instancia de <xref:System.Xml.XmlReaderSettings>.</span><span class="sxs-lookup"><span data-stu-id="55c18-111">Construct a new <xref:System.Xml.XmlReaderSettings> instance.</span></span>

2. <span data-ttu-id="55c18-112">Agregue un esquema XML a la propiedad <xref:System.Xml.XmlReaderSettings.Schemas%2A> de la instancia <xref:System.Xml.XmlReaderSettings>.</span><span class="sxs-lookup"><span data-stu-id="55c18-112">Add an XML schema to the <xref:System.Xml.XmlReaderSettings.Schemas%2A> property of the <xref:System.Xml.XmlReaderSettings> instance.</span></span>

3. <span data-ttu-id="55c18-113">Especifique `Schema` como <xref:System.Xml.XmlReaderSettings.ValidationType%2A>.</span><span class="sxs-lookup"><span data-stu-id="55c18-113">Specify `Schema` as the <xref:System.Xml.XmlReaderSettings.ValidationType%2A>.</span></span>

4. <span data-ttu-id="55c18-114">Opcionalmente, especifique <xref:System.Xml.XmlReaderSettings.ValidationFlags%2A> y <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> para que controlen las advertencias y errores de validación de esquemas que se encuentren durante la validación.</span><span class="sxs-lookup"><span data-stu-id="55c18-114">Optionally specify <xref:System.Xml.XmlReaderSettings.ValidationFlags%2A> and a <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> to handle schema validation errors and warnings encountered during validation.</span></span>

5. <span data-ttu-id="55c18-115">Por último, pase el objeto <xref:System.Xml.XmlReaderSettings> al método <xref:System.Xml.XmlReader.Create%2A> de la clase <xref:System.Xml.XmlReader> junto con el documento XML, para crear un <xref:System.Xml.XmlReader> de validación de esquemas.</span><span class="sxs-lookup"><span data-stu-id="55c18-115">Finally, pass the <xref:System.Xml.XmlReaderSettings> object to the <xref:System.Xml.XmlReader.Create%2A> method of the <xref:System.Xml.XmlReader> class along with the XML document, creating a schema-validating <xref:System.Xml.XmlReader>.</span></span>

### <a name="example"></a><span data-ttu-id="55c18-116">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="55c18-116">Example</span></span>

<span data-ttu-id="55c18-117">En el siguiente código de ejemplo, un <xref:System.Xml.XmlReader> de validación de esquemas valida los datos XML cargados en el DOM.</span><span class="sxs-lookup"><span data-stu-id="55c18-117">In the code example that follows, a schema-validating <xref:System.Xml.XmlReader> validates the XML data loaded into the DOM.</span></span> <span data-ttu-id="55c18-118">Se realizan modificaciones no válidas en el documento XML y, a continuación, dicho documento se vuelve a validar, lo que produce errores de validación del esquema.</span><span class="sxs-lookup"><span data-stu-id="55c18-118">Invalid modifications are made to the XML document and the document is then revalidated, causing schema validation errors.</span></span> <span data-ttu-id="55c18-119">Por último, se corrige uno de los errores y, a continuación, se valida parcialmente parte del documento XML.</span><span class="sxs-lookup"><span data-stu-id="55c18-119">Finally, one of the errors is corrected, and then part of the XML document is partially validated.</span></span>

[!code-cpp[XmlDocumentValidation.Load#1](../../../../samples/snippets/cpp/VS_Snippets_Data/XmlDocumentValidation.Load/CPP/XmlDocumentValidationExample.cpp#1)]
[!code-csharp[XmlDocumentValidation.Load#1](../../../../samples/snippets/csharp/VS_Snippets_Data/XmlDocumentValidation.Load/CS/XmlDocumentValidationExample.cs#1)]
[!code-vb[XmlDocumentValidation.Load#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XmlDocumentValidation.Load/VB/XmlDocumentValidationExample.vb#1)]

<span data-ttu-id="55c18-120">En el ejemplo se toma como entrada el archivo `contosoBooks.xml`.</span><span class="sxs-lookup"><span data-stu-id="55c18-120">The example takes the `contosoBooks.xml` file as input.</span></span>

[!code-xml[XPathXMLExamples#2](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xml#2)]

<span data-ttu-id="55c18-121">En el ejemplo también se toma como entrada el archivo `contosoBooks.xsd`.</span><span class="sxs-lookup"><span data-stu-id="55c18-121">The example also takes the `contosoBooks.xsd` file as input.</span></span>

[!code-xml[XPathXMLExamples#3](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xsd#3)]

<span data-ttu-id="55c18-122">Tenga en cuenta lo siguiente a la hora de validar datos XML a medida que se cargan en el DOM.</span><span class="sxs-lookup"><span data-stu-id="55c18-122">Consider the following when validating XML data as it is loaded into the DOM.</span></span>

- <span data-ttu-id="55c18-123">En el ejemplo anterior, se llama a <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> cada vez que se encuentra un tipo no válido.</span><span class="sxs-lookup"><span data-stu-id="55c18-123">In the above example, the <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> is called whenever an invalid type is encountered.</span></span> <span data-ttu-id="55c18-124">Si no se establece un <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> en el <xref:System.Xml.XmlReader> de validación, se produce una excepción <xref:System.Xml.Schema.XmlSchemaValidationException> cuando se llama a <xref:System.Xml.XmlDocument.Load%2A> si algún atributo o tipo de elemento no se corresponde con el tipo especificado en el esquema de validación.</span><span class="sxs-lookup"><span data-stu-id="55c18-124">If a <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> is not set on the validating <xref:System.Xml.XmlReader>,an <xref:System.Xml.Schema.XmlSchemaValidationException> is thrown when <xref:System.Xml.XmlDocument.Load%2A> is called if any attribute or element type does not match the corresponding type specified in the validating schema.</span></span>

- <span data-ttu-id="55c18-125">Cuando se carga un documento XML en un objeto <xref:System.Xml.XmlDocument> con un esquema asociado que define valores predeterminados, <xref:System.Xml.XmlDocument> trata estos valores predeterminados como si aparecieran en el documento XML.</span><span class="sxs-lookup"><span data-stu-id="55c18-125">When an XML document is loaded into an <xref:System.Xml.XmlDocument> object with an associated schema that defines default values, the <xref:System.Xml.XmlDocument> treats these defaults as if they appeared in the XML document.</span></span> <span data-ttu-id="55c18-126">Esto significa que la propiedad <xref:System.Xml.XmlReader.IsEmptyElement%2A> siempre devuelve `false` para un elemento que tenga los valores predeterminados del esquema.</span><span class="sxs-lookup"><span data-stu-id="55c18-126">This means that the <xref:System.Xml.XmlReader.IsEmptyElement%2A> property always returns `false` for an element that was defaulted from the schema.</span></span> <span data-ttu-id="55c18-127">Aunque estuviera en el documento XML, se escribiría como un elemento vacío.</span><span class="sxs-lookup"><span data-stu-id="55c18-127">Even if in the XML document, it was written as an empty element.</span></span>

## <a name="validating-an-xml-document-in-the-dom"></a><span data-ttu-id="55c18-128">Validación de un documento XML en el DOM</span><span class="sxs-lookup"><span data-stu-id="55c18-128">Validating an XML Document in the DOM</span></span>

<span data-ttu-id="55c18-129">El método <xref:System.Xml.XmlDocument.Validate%2A> de la clase <xref:System.Xml.XmlDocument> valida los datos XML que se cargan en el DOM con los esquemas de la propiedad <xref:System.Xml.XmlDocument> del objeto <xref:System.Xml.XmlDocument.Schemas%2A>.</span><span class="sxs-lookup"><span data-stu-id="55c18-129">The <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class validates the XML data loaded in the DOM against the schemas in the <xref:System.Xml.XmlDocument> object's <xref:System.Xml.XmlDocument.Schemas%2A> property.</span></span> <span data-ttu-id="55c18-130">Después de realizar la validación correctamente, se aplican los valores predeterminados del esquema, los valores de texto se convierten en valores atómicos como sea preciso y la información de tipos se asocia a los elementos de información validados.</span><span class="sxs-lookup"><span data-stu-id="55c18-130">After successful validation, schema defaults are applied, text values are converted to atomic values as necessary, and type information is associated with validated information items.</span></span> <span data-ttu-id="55c18-131">Como resultado, los datos XML con tipo reemplazan a los datos XML sin tipo anteriores.</span><span class="sxs-lookup"><span data-stu-id="55c18-131">As a result, typed XML data replaces previously untyped XML data.</span></span>

<span data-ttu-id="55c18-132">El siguiente ejemplo es similar al ejemplo de la sección anterior "Validación de un documento XML a medida que se carga en el DOM".</span><span class="sxs-lookup"><span data-stu-id="55c18-132">The example below is similar to the example in "Validating an XML Document As It Is Loaded into the DOM" above.</span></span> <span data-ttu-id="55c18-133">En este ejemplo, el documento XML no se valida a medida que se carga en el DOM, sino después de cargarlo en el DOM utilizando el método <xref:System.Xml.XmlDocument.Validate%2A> de la clase <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="55c18-133">In this example, the XML document is not validated as it is loaded into the DOM, but rather is validated after it has been loaded into the DOM using the <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class.</span></span> <span data-ttu-id="55c18-134">El método <xref:System.Xml.XmlDocument.Validate%2A> valida el documento XML con los esquemas XML contenidos en la propiedad <xref:System.Xml.XmlDocument.Schemas%2A> de <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="55c18-134">The <xref:System.Xml.XmlDocument.Validate%2A> method validates the XML document against the XML schemas contained in the <xref:System.Xml.XmlDocument.Schemas%2A> property of the <xref:System.Xml.XmlDocument>.</span></span> <span data-ttu-id="55c18-135">Luego, se realizan modificaciones no válidas en el documento XML y dicho documento se vuelve a validar, lo que produce errores de validación del esquema.</span><span class="sxs-lookup"><span data-stu-id="55c18-135">Invalid modifications are then made to the XML document, and the document is then revalidated, causing schema validation errors.</span></span> <span data-ttu-id="55c18-136">Por último, se corrige uno de los errores y, a continuación, se valida parcialmente parte del documento XML.</span><span class="sxs-lookup"><span data-stu-id="55c18-136">Finally, one of the errors is corrected, and then part of the XML document is partially validated.</span></span>

[!code-csharp[XmlDocumentValidation.Validate#1](../../../../samples/snippets/csharp/VS_Snippets_Data/XmlDocumentValidation.Validate/CS/XmlDocumentValidationExample.cs#1)]
[!code-vb[XmlDocumentValidation.Validate#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XmlDocumentValidation.Validate/VB/XmlDocumentValidationExample.vb#1)]

<span data-ttu-id="55c18-137">En el ejemplo se toman como entrada los archivos `contosoBooks.xml` y `contosoBooks.xsd` que se mencionan en la sección anterior "Validación de un documento XML a medida que se carga en el DOM".</span><span class="sxs-lookup"><span data-stu-id="55c18-137">The example takes as input the `contosoBooks.xml` and `contosoBooks.xsd` files referred to in "Validating an XML Document as it is Loaded into the DOM" above.</span></span>

## <a name="handling-validation-errors-and-warnings"></a><span data-ttu-id="55c18-138">Control de advertencias y errores de validación</span><span class="sxs-lookup"><span data-stu-id="55c18-138">Handling Validation Errors and Warnings</span></span>

<span data-ttu-id="55c18-139">Los errores de validación de esquemas XML se presentan durante la validación de datos XML cargados en el DOM.</span><span class="sxs-lookup"><span data-stu-id="55c18-139">XML schema validation errors are reported when validating XML data loaded in the DOM.</span></span> <span data-ttu-id="55c18-140">Todos los errores de validación de esquemas se le notifican mientras se validan los datos a medida que se cargan o cuando se valida un documento XML que no estuviera previamente validado.</span><span class="sxs-lookup"><span data-stu-id="55c18-140">You are notified about all schema validation errors found while validating the XML data as it is being loaded, or when validating a previously unvalidated XML document.</span></span>

<span data-ttu-id="55c18-141"><xref:System.Xml.Schema.ValidationEventHandler> controla los errores de validación.</span><span class="sxs-lookup"><span data-stu-id="55c18-141">Validation errors are handled by the <xref:System.Xml.Schema.ValidationEventHandler>.</span></span> <span data-ttu-id="55c18-142">Si se ha asignado un <xref:System.Xml.Schema.ValidationEventHandler> a la instancia de <xref:System.Xml.XmlReaderSettings> o se ha pasado al método <xref:System.Xml.XmlDocument.Validate%2A> de la clase <xref:System.Xml.XmlDocument>, el <xref:System.Xml.Schema.ValidationEventHandler> controlará los errores de validación de esquemas; de lo contrario, se inicia una <xref:System.Xml.Schema.XmlSchemaValidationException> cuando se encuentra un error de validación de esquema.</span><span class="sxs-lookup"><span data-stu-id="55c18-142">If a <xref:System.Xml.Schema.ValidationEventHandler> was assigned to the <xref:System.Xml.XmlReaderSettings> instance, or passed to the <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class, the <xref:System.Xml.Schema.ValidationEventHandler> will handle schema validation errors; otherwise an <xref:System.Xml.Schema.XmlSchemaValidationException> is raised when a schema validation error is encountered.</span></span>

> [!NOTE]
> <span data-ttu-id="55c18-143">Los datos XML se cargan en el DOM a pesar de los errores de validación de esquemas, a menos que <xref:System.Xml.Schema.ValidationEventHandler> inicie una excepción para detener el proceso.</span><span class="sxs-lookup"><span data-stu-id="55c18-143">The XML data is loaded into the DOM despite schema validation errors unless your <xref:System.Xml.Schema.ValidationEventHandler> raises an exception to stop the process.</span></span>
>
> <span data-ttu-id="55c18-144">No se notifican advertencias de validación de esquemas a menos que se especifique la marca <xref:System.Xml.Schema.XmlSchemaValidationFlags.ReportValidationWarnings> para el objeto <xref:System.Xml.XmlReaderSettings>.</span><span class="sxs-lookup"><span data-stu-id="55c18-144">Schema validation warnings are not reported unless the <xref:System.Xml.Schema.XmlSchemaValidationFlags.ReportValidationWarnings> flag is specified to the <xref:System.Xml.XmlReaderSettings> object.</span></span>

 <span data-ttu-id="55c18-145">Para ver ejemplos sobre <xref:System.Xml.Schema.ValidationEventHandler>, vea las secciones "Validación de un documento XML a medida que se carga en el DOM" y "Validación de un documento XML en el DOM".</span><span class="sxs-lookup"><span data-stu-id="55c18-145">For examples illustrating the <xref:System.Xml.Schema.ValidationEventHandler>, see "Validating an XML Document As It Is Loaded into the DOM" and "Validating an XML Document in the DOM" above.</span></span>

## <a name="see-also"></a><span data-ttu-id="55c18-146">Vea también</span><span class="sxs-lookup"><span data-stu-id="55c18-146">See also</span></span>

- <xref:System.Xml.XmlDocument>
- <xref:System.Xml.XmlReader>
- <xref:System.Xml.Schema.ValidationEventHandler>
- <xref:System.Xml.XmlReaderSettings>
- [<span data-ttu-id="55c18-147">Procesamiento de datos XML con el modelo DOM</span><span class="sxs-lookup"><span data-stu-id="55c18-147">Process XML Data Using the DOM Model</span></span>](process-xml-data-using-the-dom-model.md)
- [<span data-ttu-id="55c18-148">Trabajo con esquemas XML</span><span class="sxs-lookup"><span data-stu-id="55c18-148">Working with XML Schemas</span></span>](working-with-xml-schemas.md)
