---
title: Deducción de esquemas a partir de documentos XML
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
ms.assetid: f3d97d53-614d-4a04-a174-87965b7405f6
ms.openlocfilehash: 1f7b8c8b3cf51aa707a17b3a9e58c6a8c0d3d833
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/18/2020
ms.locfileid: "94830238"
---
# <a name="inferring-schemas-from-xml-documents"></a><span data-ttu-id="86ea2-102">Deducción de esquemas a partir de documentos XML</span><span class="sxs-lookup"><span data-stu-id="86ea2-102">Inferring Schemas from XML Documents</span></span>
<span data-ttu-id="86ea2-103">Este tema describe cómo utilizar la clase <xref:System.Xml.Schema.XmlSchemaInference> para deducir un lenguaje de definición de esquema XML (XSD) a partir de la estructura de un documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-103">This topic describes how to use the <xref:System.Xml.Schema.XmlSchemaInference> class to infer an XML Schema definition language (XSD) schema from the structure of an XML document.</span></span>  
  
## <a name="the-schema-inference-process"></a><span data-ttu-id="86ea2-104">El proceso de deducción de esquema</span><span class="sxs-lookup"><span data-stu-id="86ea2-104">The Schema Inference Process</span></span>  
 <span data-ttu-id="86ea2-105">La clase <xref:System.Xml.Schema.XmlSchemaInference> del espacio de nombres <xref:System.Xml.Schema?displayProperty=nameWithType> se utiliza para generar uno o más lenguajes de definición de esquema XML (XSD) a partir de la estructura de un documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-105">The <xref:System.Xml.Schema.XmlSchemaInference> class of the <xref:System.Xml.Schema?displayProperty=nameWithType> namespace is used to generate one or more XML Schema definition language (XSD) schemas from the structure of an XML document.</span></span> <span data-ttu-id="86ea2-106">Los esquemas generados podrían utilizarse para validar el documento XML original.</span><span class="sxs-lookup"><span data-stu-id="86ea2-106">The generated schemas may be used to validate the original XML document.</span></span>  
  
 <span data-ttu-id="86ea2-107">Mientras un documento XML es procesado por la clase <xref:System.Xml.Schema.XmlSchemaInference>, la clase <xref:System.Xml.Schema.XmlSchemaInference> hace suposiciones sobre los componentes de esquema que describen los elementos y atributos en el documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-107">As an XML document is processed by the <xref:System.Xml.Schema.XmlSchemaInference> class, the <xref:System.Xml.Schema.XmlSchemaInference> class makes assumptions about the schema components that describe the elements and attributes in the XML document.</span></span> <span data-ttu-id="86ea2-108">La clase <xref:System.Xml.Schema.XmlSchemaInference> también deduce componentes de esquema de forma restrictiva deduciendo el tipo más restrictivo para un elemento o atributo particular.</span><span class="sxs-lookup"><span data-stu-id="86ea2-108">The <xref:System.Xml.Schema.XmlSchemaInference> class also infers schema components in a constrained way by inferring the most restrictive type for a particular element or attribute.</span></span> <span data-ttu-id="86ea2-109">A medida que se reúne más información para el documento XML, estas restricciones se pierden deduciendo tipos menos restrictivos.</span><span class="sxs-lookup"><span data-stu-id="86ea2-109">As more information about the XML document is gathered, these constraints are loosened by inferring less restrictive types.</span></span> <span data-ttu-id="86ea2-110">El tipo menos restrictivo que puede deducirse es `xs:string`.</span><span class="sxs-lookup"><span data-stu-id="86ea2-110">The least restrictive type that can be inferred is `xs:string`.</span></span>  
  
 <span data-ttu-id="86ea2-111">Tome, por ejemplo, el siguiente fragmento de documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-111">Take, for example, the following piece of an XML document.</span></span>  
  
```xml  
<parent attribute1="6">  
    <child>One</child>  
    <child>Two</child>  
</parent>  
<parent attribute1="A" />
```  
  
 <span data-ttu-id="86ea2-112">En el ejemplo de arriba, cuando el atributo `attribute1` se encuentra con un valor de `6` mediante el proceso <xref:System.Xml.Schema.XmlSchemaInference>, se asume que es del tipo `xs:unsignedByte`.</span><span class="sxs-lookup"><span data-stu-id="86ea2-112">In the example above, when the `attribute1` attribute is encountered with a value of `6` by the <xref:System.Xml.Schema.XmlSchemaInference> process, it is assumed to be of type `xs:unsignedByte`.</span></span> <span data-ttu-id="86ea2-113">Cuando el segundo elemento `parent` se encuentra mediante el proceso <xref:System.Xml.Schema.XmlSchemaInference>, la restricción se pierde modificando el tipo `xs:string` porque el valor del atributo `attribute1` es ahora `A`.</span><span class="sxs-lookup"><span data-stu-id="86ea2-113">When the second `parent` element is encountered by the <xref:System.Xml.Schema.XmlSchemaInference> process, the constraint is loosened by modifying the type to `xs:string` because the value of the `attribute1` attribute is now `A`.</span></span> <span data-ttu-id="86ea2-114">De forma similar, el atributo `minOccurs` para todos los elementos `child` deducidos en el esquema se pierden a `minOccurs="0"` porque el segundo elemento primario no tiene elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="86ea2-114">Similarly, the `minOccurs` attribute for all the `child` elements inferred in the schema are loosened to `minOccurs="0"` because the second parent element has no child elements.</span></span>  
  
## <a name="inferring-schemas-from-xml-documents"></a><span data-ttu-id="86ea2-115">Deducción de esquemas a partir de documentos XML</span><span class="sxs-lookup"><span data-stu-id="86ea2-115">Inferring Schemas from XML Documents</span></span>  
 <span data-ttu-id="86ea2-116">La clase <xref:System.Xml.Schema.XmlSchemaInference> utiliza dos métodos sobrecargados <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A> para deducir un esquema a partir de un documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-116">The <xref:System.Xml.Schema.XmlSchemaInference> class uses two overloaded <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A> methods to infer a schema from an XML document.</span></span>  
  
 <span data-ttu-id="86ea2-117">El primer método <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> se utiliza para crear un esquema basado en un documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-117">The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to create a schema based on an XML document.</span></span> <span data-ttu-id="86ea2-118">El segundo método <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> se utiliza para deducir un esquema que describa múltiples documentos XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-118">The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to infer a schema that describes multiple XML documents.</span></span> <span data-ttu-id="86ea2-119">Por ejemplo, puede introducir múltiples documentos XML en el método <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> uno por uno para producir un esquema que describa el conjunto entero de documentos XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-119">For example, you can feed multiple XML documents to the <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method one at a time to produce a schema that describes the entire set of XML documents.</span></span>  
  
 <span data-ttu-id="86ea2-120">El primer método <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> deduce un esquema a partir de un documento XML contenido en un objeto <xref:System.Xml.XmlReader>, y devuelve un objeto <xref:System.Xml.Schema.XmlSchemaSet> que contiene el esquema deducido.</span><span class="sxs-lookup"><span data-stu-id="86ea2-120">The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method infers a schema from an XML document contained in an <xref:System.Xml.XmlReader> object, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema.</span></span> <span data-ttu-id="86ea2-121">El segundo método <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> busca un objeto <xref:System.Xml.Schema.XmlSchemaSet> para un esquema con el mismo espacio de nombres de destino que el documento XML contenido en el objeto <xref:System.Xml.XmlReader>, refina el esquema existente y devuelve un objeto <xref:System.Xml.Schema.XmlSchemaSet> que contiene el esquema deducido.</span><span class="sxs-lookup"><span data-stu-id="86ea2-121">The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method searches an <xref:System.Xml.Schema.XmlSchemaSet> object for a schema with the same target namespace as the XML document contained in the <xref:System.Xml.XmlReader> object, refines the existing schema, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema.</span></span>  
  
 <span data-ttu-id="86ea2-122">Los cambios realizados en el esquema refinado se basan en la nueva estructura encontrada en el documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-122">The changes made to the refined schema are based on new structure found in the XML document.</span></span> <span data-ttu-id="86ea2-123">Por ejemplo, mientras se atraviesa un documento XML, se realizan suposiciones sobre los tipos de datos encontrados y el esquema se crea basándose en dichas suposiciones.</span><span class="sxs-lookup"><span data-stu-id="86ea2-123">For example, as an XML document is traversed, assumptions are made about the data types found, and the schema is created based on those assumptions.</span></span> <span data-ttu-id="86ea2-124">No obstante, si los datos se encuentra en un segundo pase de deducción que difiere de la suposición original, el esquema se refina.</span><span class="sxs-lookup"><span data-stu-id="86ea2-124">However, if data is encountered on a second inference pass that differs from the original assumption, the schema is refined.</span></span> <span data-ttu-id="86ea2-125">En el ejemplo siguiente se muestra el proceso de refinamiento.</span><span class="sxs-lookup"><span data-stu-id="86ea2-125">The following example illustrates the refinement process.</span></span>  
  
 [!code-cpp[XmlSchemaInferenceExamples#4](../../../../samples/snippets/cpp/VS_Snippets_Data/XmlSchemaInferenceExamples/CPP/XmlSchemaInferenceExamples.cpp#4)]
 [!code-csharp[XmlSchemaInferenceExamples#4](../../../../samples/snippets/csharp/VS_Snippets_Data/XmlSchemaInferenceExamples/CS/XmlSchemaInferenceExamples.cs#4)]
 [!code-vb[XmlSchemaInferenceExamples#4](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XmlSchemaInferenceExamples/VB/XmlSchemaInferenceExamples.vb#4)]  
  
 <span data-ttu-id="86ea2-126">El ejemplo toma el siguiente archivo, `item1.xml`, como su primera entrada.</span><span class="sxs-lookup"><span data-stu-id="86ea2-126">The example takes the following file, `item1.xml`, as its first input.</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#13](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/item1.xml#13)]  
  
 <span data-ttu-id="86ea2-127">A continuación, toma el archivo `item2.xml` como su segunda entrada:</span><span class="sxs-lookup"><span data-stu-id="86ea2-127">The example then takes the `item2.xml` file as its second input:</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#14](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/item2.xml#14)]  
  
 <span data-ttu-id="86ea2-128">Cuando se encuentra el atributo `productID` en el primer documento XML, el valor de `123456789` se asume que es de tipo `xs:unsignedInt`.</span><span class="sxs-lookup"><span data-stu-id="86ea2-128">When the `productID` attribute is encountered in the first XML document, the value of `123456789` is assumed to be an `xs:unsignedInt` type.</span></span> <span data-ttu-id="86ea2-129">Sin embargo, cuando se lee el segundo documento XML y se encuentra el valor de `A53-246`, el tipo `xs:unsignedInt` no puede asumirse más.</span><span class="sxs-lookup"><span data-stu-id="86ea2-129">However, when the second XML document is read and the value of `A53-246` is found, the `xs:unsignedInt` type can no longer be assumed.</span></span> <span data-ttu-id="86ea2-130">El esquema se refina y el tipo de `productID` cambia a `xs:string`.</span><span class="sxs-lookup"><span data-stu-id="86ea2-130">The schema is refined and the type of `productID` is changed to `xs:string`.</span></span> <span data-ttu-id="86ea2-131">Además, el atributo `minOccurs` para el elemento `supplierID` se establece en `0`, porque el segundo documento XML no contiene ningún elemento `supplierID`.</span><span class="sxs-lookup"><span data-stu-id="86ea2-131">In addition, the `minOccurs` attribute for the `supplierID` element is set to `0`, because the second XML document contains no `supplierID` element.</span></span>  
  
 <span data-ttu-id="86ea2-132">El siguiente es el esquema deducido a partir del primer documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-132">The following is the schema inferred from the first XML document.</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#15](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/InferSchema1.xml#15)]  
  
 <span data-ttu-id="86ea2-133">El siguiente es el esquema deducido a partir del primer documento XML, refinado mediante el segundo documento XML.</span><span class="sxs-lookup"><span data-stu-id="86ea2-133">The following is the schema inferred from the first XML document, refined by the second XML document.</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#16](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/InferSchema2.xml#16)]  
  
## <a name="inline-schemas"></a><span data-ttu-id="86ea2-134">Esquemas alineados</span><span class="sxs-lookup"><span data-stu-id="86ea2-134">Inline Schemas</span></span>  
 <span data-ttu-id="86ea2-135">Si un lenguaje de definición de esquema XML alineado (XSD) se encuentra durante el proceso <xref:System.Xml.Schema.XmlSchemaInference>, se inicia <xref:System.Xml.Schema.XmlSchemaInferenceException>.</span><span class="sxs-lookup"><span data-stu-id="86ea2-135">If an inline XML Schema definition language (XSD) schema is encountered during the <xref:System.Xml.Schema.XmlSchemaInference> process, an <xref:System.Xml.Schema.XmlSchemaInferenceException> is thrown.</span></span> <span data-ttu-id="86ea2-136">Por ejemplo, el siguiente esquema alineado inicia <xref:System.Xml.Schema.XmlSchemaInferenceException>.</span><span class="sxs-lookup"><span data-stu-id="86ea2-136">For example, the following inline schema throws an <xref:System.Xml.Schema.XmlSchemaInferenceException>.</span></span>  
  
```xml  
<root xmlns:ex="http://www.contoso.com" xmlns="http://www.tempuri.org">  
    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.contoso.com">  
        <xs:element name="Contoso" type="xs:normalizedString" />  
    </xs:schema>  
    <ex:Contoso>Test</ex:Contoso>  
</root>  
```  
  
## <a name="schemas-that-cannot-be-refined"></a><span data-ttu-id="86ea2-137">Esquemas que no pueden refinarse</span><span class="sxs-lookup"><span data-stu-id="86ea2-137">Schemas that Cannot be Refined</span></span>  
 <span data-ttu-id="86ea2-138">Existen construcciones de esquema XML de W3C que el proceso <xref:System.Xml.Schema.XmlSchemaInference> de lenguaje de definición de esquema XML (XSD) no puede controlar si se da un tipo para refinar y provoca que se inicie una excepción.</span><span class="sxs-lookup"><span data-stu-id="86ea2-138">There are W3C XML Schema constructs that the XML Schema definition language (XSD) schema <xref:System.Xml.Schema.XmlSchemaInference> process cannot handle if given a type to refine and cause an exception to be thrown.</span></span> <span data-ttu-id="86ea2-139">Como un tipo complejo cuyo compositor de nivel superior es una secuencia.</span><span class="sxs-lookup"><span data-stu-id="86ea2-139">Such as a complex type whose top-level compositor is anything other than a sequence.</span></span> <span data-ttu-id="86ea2-140">En el modelo de objeto de esquema (SOM), esto corresponde a <xref:System.Xml.Schema.XmlSchemaComplexType> cuya propiedad <xref:System.Xml.Schema.XmlSchemaComplexType.Particle%2A> no es una instancia de <xref:System.Xml.Schema.XmlSchemaSequence>.</span><span class="sxs-lookup"><span data-stu-id="86ea2-140">In the Schema Object Model (SOM), this corresponds to an <xref:System.Xml.Schema.XmlSchemaComplexType> whose <xref:System.Xml.Schema.XmlSchemaComplexType.Particle%2A> property is not an instance of <xref:System.Xml.Schema.XmlSchemaSequence>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="86ea2-141">Vea también</span><span class="sxs-lookup"><span data-stu-id="86ea2-141">See also</span></span>

- <xref:System.Xml.Schema.XmlSchemaInference>
- [<span data-ttu-id="86ea2-142">Modelo de objetos de esquema XML (SOM)</span><span class="sxs-lookup"><span data-stu-id="86ea2-142">XML Schema Object Model (SOM)</span></span>](xml-schema-object-model-som.md)
- [<span data-ttu-id="86ea2-143">Deducción de esquema XML</span><span class="sxs-lookup"><span data-stu-id="86ea2-143">Inferring an XML Schema</span></span>](inferring-an-xml-schema.md)
- [<span data-ttu-id="86ea2-144">Reglas para deducir los tipos de nodo de esquema y estructura</span><span class="sxs-lookup"><span data-stu-id="86ea2-144">Rules for Inferring Schema Node Types and Structure</span></span>](rules-for-inferring-schema-node-types-and-structure.md)
- [<span data-ttu-id="86ea2-145">Reglas para deducir tipos simples</span><span class="sxs-lookup"><span data-stu-id="86ea2-145">Rules for Inferring Simple Types</span></span>](rules-for-inferring-simple-types.md)
