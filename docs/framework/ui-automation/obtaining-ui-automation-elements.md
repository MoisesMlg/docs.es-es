---
title: Obtener elementos de UI Automation
description: Revise varias formas de obtener objetos de elemento de automatización de la interfaz de usuario (AutomationElement) para los elementos de la interfaz de usuario.
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, obtaining elements
- elements, UI Automation, obtaining
ms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171
ms.openlocfilehash: 66a8d9e944a8f8a777ec744a33f2cdb2d33e200c
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96237357"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="64148-103">Obtener elementos de UI Automation</span><span class="sxs-lookup"><span data-stu-id="64148-103">Obtaining UI Automation Elements</span></span>

> [!NOTE]
> <span data-ttu-id="64148-104">Esta documentación está dirigida a los desarrolladores de .NET Framework que quieran usar las clases [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] administradas definidas en el espacio de nombres <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="64148-104">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="64148-105">Para ver la información más reciente acerca de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], consulte [Windows Automation API: automatización de la interfaz de usuario](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="64148-105">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="64148-106">En este tema se describen las distintas formas de obtener objetos <xref:System.Windows.Automation.AutomationElement> para elementos [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="64148-106">This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="64148-107">Si la aplicación cliente intenta buscar elementos en su propia interfaz de usuario, debe realizar todos las llamadas a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] en un subproceso independiente.</span><span class="sxs-lookup"><span data-stu-id="64148-107">If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread.</span></span> <span data-ttu-id="64148-108">Para obtener más información, consulta [UI Automation Threading Issues](ui-automation-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="64148-108">For more information, see [UI Automation Threading Issues](ui-automation-threading-issues.md).</span></span>  
  
<a name="The_Root_Element"></a>

## <a name="root-element"></a><span data-ttu-id="64148-109">Elemento raíz</span><span class="sxs-lookup"><span data-stu-id="64148-109">Root Element</span></span>  

 <span data-ttu-id="64148-110">Todas las búsquedas de objetos <xref:System.Windows.Automation.AutomationElement> deben tener un punto de inicio.</span><span class="sxs-lookup"><span data-stu-id="64148-110">All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place.</span></span> <span data-ttu-id="64148-111">Puede ser cualquier elemento, incluidos el escritorio, una ventana de aplicación o un control.</span><span class="sxs-lookup"><span data-stu-id="64148-111">This can be any element, including the desktop, an application window, or a control.</span></span>  
  
 <span data-ttu-id="64148-112">El elemento raíz para el escritorio, del que descienden todos los elementos, se obtiene de la propiedad estática <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="64148-112">The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> property.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="64148-113">En general, debe intentar obtener solo elementos secundarios directos del elemento <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="64148-113">In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span> <span data-ttu-id="64148-114">Una búsqueda de descendientes puede iterar a través de cientos o incluso miles de elementos, lo que posiblemente provocaría un desbordamiento de pila.</span><span class="sxs-lookup"><span data-stu-id="64148-114">A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.</span></span> <span data-ttu-id="64148-115">Si intenta obtener un elemento concreto en un nivel inferior, debe iniciar la búsqueda desde la ventana de aplicación o desde un contenedor en un nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="64148-115">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>  
  
<a name="Using_Conditions"></a>

## <a name="conditions"></a><span data-ttu-id="64148-116">Condiciones</span><span class="sxs-lookup"><span data-stu-id="64148-116">Conditions</span></span>  

 <span data-ttu-id="64148-117">Para la mayoría de técnicas que puede usar para recuperar elementos [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , debe especificar un elemento <xref:System.Windows.Automation.Condition>, que es un conjunto de criterios que definen los elementos que quiere recuperar.</span><span class="sxs-lookup"><span data-stu-id="64148-117">For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve.</span></span>  
  
 <span data-ttu-id="64148-118">La condición más simple es <xref:System.Windows.Automation.Condition.TrueCondition>, un objeto predefinido que especifica que se devolverán todos los elementos dentro del ámbito de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="64148-118">The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned.</span></span> <span data-ttu-id="64148-119"><xref:System.Windows.Automation.Condition.FalseCondition>, que es el elemento opuesto de <xref:System.Windows.Automation.Condition.TrueCondition>, no es tan útil, ya que impediría que se encontraran elementos.</span><span class="sxs-lookup"><span data-stu-id="64148-119"><xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found.</span></span>  
  
 <span data-ttu-id="64148-120">Hay otras tres condiciones predefinidas que se pueden utilizar por sí solas o en combinación con otras condiciones: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>y <xref:System.Windows.Automation.Automation.RawViewCondition>.</span><span class="sxs-lookup"><span data-stu-id="64148-120">Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>.</span></span> <span data-ttu-id="64148-121"><xref:System.Windows.Automation.Automation.RawViewCondition>, por sí sola, equivale a <xref:System.Windows.Automation.Condition.TrueCondition>, porque no filtra los elementos por sus propiedades <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> o <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> .</span><span class="sxs-lookup"><span data-stu-id="64148-121"><xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties.</span></span>  
  
 <span data-ttu-id="64148-122">Otras condiciones se componen de uno o varios objetos <xref:System.Windows.Automation.PropertyCondition> , cada uno de los cuales especifica un valor de propiedad.</span><span class="sxs-lookup"><span data-stu-id="64148-122">Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value.</span></span> <span data-ttu-id="64148-123">Por ejemplo, un elemento <xref:System.Windows.Automation.PropertyCondition> podría especificar que el elemento está habilitado o que admite un patrón de control determinado.</span><span class="sxs-lookup"><span data-stu-id="64148-123">For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern.</span></span>  
  
 <span data-ttu-id="64148-124">Las condiciones se pueden combinar con lógica booleana, mediante la construcción de objetos de tipos <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>y <xref:System.Windows.Automation.NotCondition>.</span><span class="sxs-lookup"><span data-stu-id="64148-124">Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>.</span></span>  
  
<a name="Search_Scope"></a>

## <a name="search-scope"></a><span data-ttu-id="64148-125">Ámbito de búsqueda</span><span class="sxs-lookup"><span data-stu-id="64148-125">Search Scope</span></span>  

 <span data-ttu-id="64148-126">Las búsquedas realizadas con <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> o <xref:System.Windows.Automation.AutomationElement.FindAll%2A> deben tener un ámbito así como un punto de inicio.</span><span class="sxs-lookup"><span data-stu-id="64148-126">Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place.</span></span>  
  
 <span data-ttu-id="64148-127">El ámbito define el espacio alrededor del punto de inicio en el que se va a buscar.</span><span class="sxs-lookup"><span data-stu-id="64148-127">The scope defines the space around the starting-place that is to be searched.</span></span> <span data-ttu-id="64148-128">Esto podría incluir el propio elemento, sus elementos relacionados, su elemento primario, sus antecesores, sus elementos secundarios inmediatos y sus descendientes.</span><span class="sxs-lookup"><span data-stu-id="64148-128">This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.</span></span>  
  
 <span data-ttu-id="64148-129">El ámbito de una búsqueda se define mediante una combinación bit a bit de valores de la enumeración <xref:System.Windows.Automation.TreeScope> .</span><span class="sxs-lookup"><span data-stu-id="64148-129">The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration.</span></span>  
  
<a name="Finding_a_Known_Element"></a>

## <a name="finding-a-known-element"></a><span data-ttu-id="64148-130">Búsqueda de un elemento conocido</span><span class="sxs-lookup"><span data-stu-id="64148-130">Finding a Known Element</span></span>  

 <span data-ttu-id="64148-131">Para buscar un elemento conocido, identificado por su <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>o alguna otra propiedad o combinación de propiedades, lo más fácil es utilizar el método <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> .</span><span class="sxs-lookup"><span data-stu-id="64148-131">To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method.</span></span> <span data-ttu-id="64148-132">Si el elemento que se busca es una ventana de aplicación, el punto inicial de la búsqueda puede ser el elemento <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="64148-132">If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span>  
  
 <span data-ttu-id="64148-133">Esta forma de buscar elementos [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] es especialmente útil en escenarios de pruebas automatizadas.</span><span class="sxs-lookup"><span data-stu-id="64148-133">This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios.</span></span>  
  
<a name="Finding_Elements_in_a_Subtree"></a>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="64148-134">Búsqueda de elementos en un subárbol</span><span class="sxs-lookup"><span data-stu-id="64148-134">Finding Elements in a Subtree</span></span>  

 <span data-ttu-id="64148-135">Para encontrar todos los elementos que cumplan criterios concretos relacionados con un elemento conocido, puede utilizar <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span><span class="sxs-lookup"><span data-stu-id="64148-135">To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span></span> <span data-ttu-id="64148-136">Por ejemplo, podría utilizar este método para recuperar elementos de lista o elementos de menú de una lista o un menú, o para identificar todos los controles de un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="64148-136">For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>  
  
<a name="Walking_a_Subtree"></a>

## <a name="walking-a-subtree"></a><span data-ttu-id="64148-137">Recorrer un subárbol</span><span class="sxs-lookup"><span data-stu-id="64148-137">Walking a Subtree</span></span>  

 <span data-ttu-id="64148-138">Si no tiene conocimiento previo de las aplicaciones con las que se puede usar el cliente, puede construir un subárbol de todos los elementos de interés con la clase <xref:System.Windows.Automation.TreeWalker> .</span><span class="sxs-lookup"><span data-stu-id="64148-138">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class.</span></span> <span data-ttu-id="64148-139">La aplicación podría hacer esto en respuesta a un evento de cambio de foco; es decir, cuando una aplicación o un control recibe el foco de entrada, el cliente de Automatización de la interfaz de usuario examina los elementos secundarios y quizás todos los descendientes del elemento en el que está el foco.</span><span class="sxs-lookup"><span data-stu-id="64148-139">Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>  
  
 <span data-ttu-id="64148-140">Otra forma en que se puede utilizar <xref:System.Windows.Automation.TreeWalker> es para identificar los antecesores de un elemento.</span><span class="sxs-lookup"><span data-stu-id="64148-140">Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element.</span></span> <span data-ttu-id="64148-141">Por ejemplo, al recorrer el árbol en sentido ascendente, se puede identificar la ventana primaria de un control.</span><span class="sxs-lookup"><span data-stu-id="64148-141">For example, by walking up the tree you can identify the parent window of a control.</span></span>  
  
 <span data-ttu-id="64148-142">Puede usar <xref:System.Windows.Automation.TreeWalker> mediante la creación de un objeto de la clase (definiendo los elementos de interés pasando un elemento <xref:System.Windows.Automation.Condition>) o mediante uno de los siguientes objetos predefinidos que se definen como campos de <xref:System.Windows.Automation.TreeWalker>.</span><span class="sxs-lookup"><span data-stu-id="64148-142">You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>.</span></span>  
  
|||  
|-|-|  
|<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>|<span data-ttu-id="64148-143">Busca únicamente los elementos cuya propiedad <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> sea `true`.</span><span class="sxs-lookup"><span data-stu-id="64148-143">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>|<span data-ttu-id="64148-144">Busca únicamente los elementos cuya propiedad <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> sea `true`.</span><span class="sxs-lookup"><span data-stu-id="64148-144">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.RawViewWalker>|<span data-ttu-id="64148-145">Busca todos los elementos.</span><span class="sxs-lookup"><span data-stu-id="64148-145">Finds all elements.</span></span>|  
  
 <span data-ttu-id="64148-146">Después de haber obtenido un elemento <xref:System.Windows.Automation.TreeWalker>, su uso es sencillo.</span><span class="sxs-lookup"><span data-stu-id="64148-146">After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward.</span></span> <span data-ttu-id="64148-147">Basta con llamar a los métodos `Get` para navegar entre elementos del subárbol.</span><span class="sxs-lookup"><span data-stu-id="64148-147">Simply call the `Get` methods to navigate among elements of the subtree.</span></span>  
  
 <span data-ttu-id="64148-148">El método <xref:System.Windows.Automation.TreeWalker.Normalize%2A> puede utilizarse para desplazarse a un elemento del subárbol desde otro elemento que no forma parte de la vista.</span><span class="sxs-lookup"><span data-stu-id="64148-148">The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="64148-149">Por ejemplo, suponga que ha creado una vista de un subárbol mediante <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span><span class="sxs-lookup"><span data-stu-id="64148-149">For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span></span> <span data-ttu-id="64148-150">Después, la aplicación recibe la notificación de que una barra de desplazamiento ha recibido el foco de entrada.</span><span class="sxs-lookup"><span data-stu-id="64148-150">Your application then receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="64148-151">Como una barra de desplazamiento no es un elemento de contenido, no está presente en la vista del subárbol.</span><span class="sxs-lookup"><span data-stu-id="64148-151">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="64148-152">Sin embargo, puede pasar el elemento <xref:System.Windows.Automation.AutomationElement> que representa la barra de desplazamiento a <xref:System.Windows.Automation.TreeWalker.Normalize%2A> y recuperar el antecesor más cercano que se encuentra en la vista de contenido.</span><span class="sxs-lookup"><span data-stu-id="64148-152">However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view.</span></span>  
  
<a name="Other_Ways_to_Retrieve_an_Element"></a>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="64148-153">Otras maneras de recuperar un elemento</span><span class="sxs-lookup"><span data-stu-id="64148-153">Other Ways to Retrieve an Element</span></span>  

 <span data-ttu-id="64148-154">Además de las búsquedas y la navegación, puede recuperar un elemento <xref:System.Windows.Automation.AutomationElement> de las maneras siguientes.</span><span class="sxs-lookup"><span data-stu-id="64148-154">In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways.</span></span>  
  
### <a name="from-an-event"></a><span data-ttu-id="64148-155">Desde un evento</span><span class="sxs-lookup"><span data-stu-id="64148-155">From an Event</span></span>  

 <span data-ttu-id="64148-156">Cuando la aplicación recibe un evento [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , el objeto de origen que se pasa al controlador de eventos es un elemento <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="64148-156">When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="64148-157">Por ejemplo, si se ha suscrito a eventos de cambio de foco, el origen que se pasó a su <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> es el elemento que recibió el foco.</span><span class="sxs-lookup"><span data-stu-id="64148-157">For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus.</span></span>  
  
 <span data-ttu-id="64148-158">Para obtener más información, consulta [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span><span class="sxs-lookup"><span data-stu-id="64148-158">For more information, see [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span></span>  
  
### <a name="from-a-point"></a><span data-ttu-id="64148-159">Desde un punto</span><span class="sxs-lookup"><span data-stu-id="64148-159">From a Point</span></span>  

 <span data-ttu-id="64148-160">Si tiene coordenadas de pantalla (por ejemplo, una posición del cursor), puede recuperar un elemento <xref:System.Windows.Automation.AutomationElement> con el método estático <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> .</span><span class="sxs-lookup"><span data-stu-id="64148-160">If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method.</span></span>  
  
### <a name="from-a-window-handle"></a><span data-ttu-id="64148-161">Desde un identificador de ventana</span><span class="sxs-lookup"><span data-stu-id="64148-161">From a Window Handle</span></span>  

 <span data-ttu-id="64148-162">Para recuperar un elemento <xref:System.Windows.Automation.AutomationElement> desde un HWND, use el método estático <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> .</span><span class="sxs-lookup"><span data-stu-id="64148-162">To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method.</span></span>  
  
### <a name="from-the-focused-control"></a><span data-ttu-id="64148-163">Desde el control con el foco</span><span class="sxs-lookup"><span data-stu-id="64148-163">From the Focused Control</span></span>  

 <span data-ttu-id="64148-164">Puede recuperar un elemento <xref:System.Windows.Automation.AutomationElement> que representa el control con el foco desde la propiedad estática <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> .</span><span class="sxs-lookup"><span data-stu-id="64148-164">You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="64148-165">Vea también</span><span class="sxs-lookup"><span data-stu-id="64148-165">See also</span></span>

- [<span data-ttu-id="64148-166">Buscar un elemento de UI Automation basándose en una condición de propiedad</span><span class="sxs-lookup"><span data-stu-id="64148-166">Find a UI Automation Element Based on a Property Condition</span></span>](find-a-ui-automation-element-based-on-a-property-condition.md)
- [<span data-ttu-id="64148-167">Navegar entre elementos de UI Automation con TreeWalker</span><span class="sxs-lookup"><span data-stu-id="64148-167">Navigate Among UI Automation Elements with TreeWalker</span></span>](navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="64148-168">Información general sobre el árbol de la UI Automation</span><span class="sxs-lookup"><span data-stu-id="64148-168">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
