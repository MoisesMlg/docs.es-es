---
title: Almacenes de instancias
ms.date: 03/30/2017
ms.assetid: f2629668-0923-4987-b943-67477131c1e0
ms.openlocfilehash: 0e3cc0c6c635d9c42b4242581ce039b186116113
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96279875"
---
# <a name="instance-stores"></a><span data-ttu-id="50a63-102">Almacenes de instancias</span><span class="sxs-lookup"><span data-stu-id="50a63-102">Instance Stores</span></span>

<span data-ttu-id="50a63-103">Un almacén de instancias es un contenedor lógico de instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-103">An instance store is a logical container of instances.</span></span> <span data-ttu-id="50a63-104">Es el lugar donde se almacenan los metadatos y los datos de las instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-104">It is the place where the instance data and metadata is stored.</span></span> <span data-ttu-id="50a63-105">Un almacén de instancias no tiene que ser necesariamente un almacenamiento físico dedicado.</span><span class="sxs-lookup"><span data-stu-id="50a63-105">An instance store does not imply dedicated physical storage.</span></span> <span data-ttu-id="50a63-106">Un almacén de instancias puede contener información duradera de una base de datos de SQL Server o información de estado no duradera de una memoria.</span><span class="sxs-lookup"><span data-stu-id="50a63-106">An instance store could contain durable information in a SQL Server database or non-durable state information in a memory.</span></span> <span data-ttu-id="50a63-107">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] distribuye con el Almacén de instancias de flujos de trabajo de SQL, que es una implementación concreta de un almacén de instancias que permite a los flujos de trabajo conservar metadatos y datos de instancia en una base de datos de SQL Server 2005 o SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="50a63-107">The [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] ships with the SQL Workflow Instance Store, which is a concrete implementation of an instance store that allows workflows to persist instance data and metadata into a SQL Server 2005 or SQL Server 2008 database.</span></span> <span data-ttu-id="50a63-108">Además, Windows Server App Fabric también proporciona una implementación concreta de un almacén de instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-108">In addition Windows Server App Fabric also provides a concrete implementation of an instance store.</span></span> <span data-ttu-id="50a63-109">Para obtener más información, consulte [proveedores de control, consulta y almacén de instancias de Windows Server App fabric](/previous-versions/appfabric/ff383417(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="50a63-109">For more information, see [Windows Server App Fabric Instance Store, Query, and Control Providers](/previous-versions/appfabric/ff383417(v=azure.10)).</span></span>  
  
 <span data-ttu-id="50a63-110">La API de persistencia es la interfaz entre un host y un almacén de instancias que permite al host enviar las solicitudes de comando al almacén de instancias (por ejemplo, <xref:System.Activities.DurableInstancing.LoadWorkflowCommand> y <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>).</span><span class="sxs-lookup"><span data-stu-id="50a63-110">The persistence API is the interface between a host and an instance store that allows the host to send command requests (for example, <xref:System.Activities.DurableInstancing.LoadWorkflowCommand> and <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>) to the instance store.</span></span> <span data-ttu-id="50a63-111">La implementación concreta de esta API se denomina proveedor de persistencia.</span><span class="sxs-lookup"><span data-stu-id="50a63-111">The concrete implementation of this API is called a persistence provider.</span></span> <span data-ttu-id="50a63-112">El proveedor de persistencia recibe solicitudes de un host y modifica el almacén de instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-112">The persistence provider receives requests from a host and modifies the instance store.</span></span>  
  
 <span data-ttu-id="50a63-113">Los hosts y los almacenes de instancias son conectables, de forma que un host puede usarse con varios almacenes de instancias y un almacén de instancias, con varios hosts.</span><span class="sxs-lookup"><span data-stu-id="50a63-113">Hosts and instance stores are pluggable so that a host can be used with many instance stores, and an instance store can be used with many hosts.</span></span> <span data-ttu-id="50a63-114">Un almacén de instancias está optimizado normalmente para los patrones de uso de un host determinado, aunque el almacén de instancias y el host pueden evolucionar en ciclos de vida independientes.</span><span class="sxs-lookup"><span data-stu-id="50a63-114">An instance store is typically optimized for the usage patterns of a particular host, although the instance store and host may evolve on independent life cycles.</span></span> <span data-ttu-id="50a63-115">Por ejemplo, **WorkflowServiceHost** y **SqlWorkflowInstanceStore** están diseñados para funcionar bien juntos.</span><span class="sxs-lookup"><span data-stu-id="50a63-115">For example, the **WorkflowServiceHost** and the **SqlWorkflowInstanceStore** are designed to work well together.</span></span> <span data-ttu-id="50a63-116">Puede crear su propio almacén de instancias para conservar los datos y metadatos de las instancias de servicio de flujo de trabajo y usar ese almacén de instancias con **WorkflowServiceHost**.</span><span class="sxs-lookup"><span data-stu-id="50a63-116">You can create your own instance store to persist data and metadata of workflow service instances and use that instance store with the **WorkflowServiceHost**.</span></span> <span data-ttu-id="50a63-117">Por ejemplo, puede crear un almacén de instancias OracleWorkflowInstanceStore que permita a los flujos de trabajo conservar información en una base de datos Oracle en lugar de almacenarla en una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="50a63-117">For example, you can create an OracleWorkflowInstanceStore that lets workflows persist information into an Oracle database instead of saving them into a SQL Server database.</span></span>  
  
 <span data-ttu-id="50a63-118">Resulta habitual ampliar los hosts con funciones que modifiquen los objetos conservados.</span><span class="sxs-lookup"><span data-stu-id="50a63-118">It is common for hosts to be extended with additional functionality that modifies the persisted objects.</span></span> <span data-ttu-id="50a63-119">Por ejemplo, un sistema de persistencia de instancias puede tener un host de flujo de trabajo, una extensión que admite la operación "suspender" y un almacén de instancias de SQL.</span><span class="sxs-lookup"><span data-stu-id="50a63-119">For example, an instance persistence system may have a workflow host, an extension that supports the "Suspend" operation, and an SQL instance store.</span></span>  <span data-ttu-id="50a63-120">El host de flujo de trabajo podría enviar un comando estándar, como Guardar o Cargar, para guardar o cargar un flujo de trabajo de un almacén de instancias, o bien para guardar un flujo de trabajo en un almacén de instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-120">The workflow host might send a standard command such as Save or Load to save or load a workflow from an instance store or to save a workflow into an instance store.</span></span> <span data-ttu-id="50a63-121">La extensión de Suspend podría agregar semántica adicional a los comandos para guardar y cargar instancias de flujo de trabajo, de forma que no pueda cargarse una instancia de flujo de trabajo suspendida.</span><span class="sxs-lookup"><span data-stu-id="50a63-121">The suspend extension might add additional semantics to the commands for saving and loading workflow instances so that a suspended workflow instance cannot be loaded.</span></span> <span data-ttu-id="50a63-122">El proveedor de persistencia del almacén de instancias de SQL entiende los comandos para guardar y cargar instancias de flujo de trabajo, e implementa los comandos realizando llamadas a los procedimientos almacenados adecuados para cambiar las tablas de objetos permanentes en una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="50a63-122">The persistence provider for the SQL instance store understands the commands for saving and loading workflow instances, and implements the commands by calling appropriate stored procedures that change the tables of persistent objects in an SQL Server database.</span></span>  
  
 <span data-ttu-id="50a63-123">Un host actúa como propietario de una instancia en un almacén de instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-123">A host acts as an instance owner within an instance store.</span></span> <span data-ttu-id="50a63-124">Puede actuar al mismo tiempo como propietario de más de una instancia y disponer de varios almacenes de instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-124">A host may act as more than one instance owner with more than one instance store at the same time.</span></span> <span data-ttu-id="50a63-125">El host proporciona GUID para las claves de instancia asociadas a las instancias.</span><span class="sxs-lookup"><span data-stu-id="50a63-125">The host provides GUIDs for instance keys associated with the instances.</span></span> <span data-ttu-id="50a63-126">Una clave de instancia es un alias no único que identifica una instancia.</span><span class="sxs-lookup"><span data-stu-id="50a63-126">An instance key is a unique alias that identifies an instance.</span></span> <span data-ttu-id="50a63-127">El sistema de persistencia crea, actualiza y elimina información del propietario de la instancia cuando ejecuta comandos solicitados por hosts.</span><span class="sxs-lookup"><span data-stu-id="50a63-127">The persistence system creates, updates, and deletes instance owner information as it executes commands requested by hosts.</span></span>  
  
 <span data-ttu-id="50a63-128">La siguiente lista contiene los pasos importantes para la interacción del host con el almacén de instancias:</span><span class="sxs-lookup"><span data-stu-id="50a63-128">The following list contains the important steps involved in the host’s interaction with the instance store:</span></span>  
  
1. <span data-ttu-id="50a63-129">Obtener un **InstanceStore** de un proveedor de persistencia.</span><span class="sxs-lookup"><span data-stu-id="50a63-129">Obtain an **InstanceStore** from a persistence provider.</span></span>  

2. <span data-ttu-id="50a63-130">Obtenga el identificador de una instancia llamando al <xref:System.Runtime.DurableInstancing.InstanceStore.CreateInstanceHandle%2A> método en **InstanceStore**.</span><span class="sxs-lookup"><span data-stu-id="50a63-130">Obtain the handle to an instance by calling the <xref:System.Runtime.DurableInstancing.InstanceStore.CreateInstanceHandle%2A> method on the **InstanceStore**.</span></span>  
  
3. <span data-ttu-id="50a63-131">Invocar comandos en el identificador de instancia llamando al <xref:System.Runtime.DurableInstancing.InstanceStore.Execute%2A> método en **InstanceStore**.</span><span class="sxs-lookup"><span data-stu-id="50a63-131">Invoke commands against the instance handle by calling the <xref:System.Runtime.DurableInstancing.InstanceStore.Execute%2A> method on the **InstanceStore**.</span></span>  
  
4. <span data-ttu-id="50a63-132">Examine el <xref:System.Runtime.DurableInstancing.InstanceView> devuelto por **InstanceStore.Exe** de la función de los resultados para determinar los resultados de los comandos.</span><span class="sxs-lookup"><span data-stu-id="50a63-132">Examine the <xref:System.Runtime.DurableInstancing.InstanceView> returned by **InstanceStore.Execute** to determine the results of the commands.</span></span>
