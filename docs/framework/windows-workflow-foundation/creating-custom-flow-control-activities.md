---
title: Crear actividades de control de flujo personalizadas
ms.date: 03/30/2017
ms.assetid: 27f409f6-2d1d-4cfb-9765-93eb2ad667d5
ms.openlocfilehash: 92d98d33b10e431248c4c482fcd26f3036c4c330
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96242076"
---
# <a name="creating-custom-flow-control-activities"></a><span data-ttu-id="db1bc-102">Crear actividades de control de flujo personalizadas</span><span class="sxs-lookup"><span data-stu-id="db1bc-102">Creating custom flow control activities</span></span>

<span data-ttu-id="db1bc-103">El .NET Framework contiene una variedad de actividades de control de flujo que funcionan de forma similar a las estructuras de programación abstractas (como <xref:System.Activities.Statements.Flowchart> ) o a instrucciones de programación estándar (como <xref:System.Activities.Statements.If> ).</span><span class="sxs-lookup"><span data-stu-id="db1bc-103">The .NET Framework contains a variety of flow-control activities that function similarly to abstract programming structures (such as <xref:System.Activities.Statements.Flowchart>)   or to standard programming statements (such as <xref:System.Activities.Statements.If>).</span></span> <span data-ttu-id="db1bc-104">En este tema se describe la arquitectura de uno de los proyectos de ejemplo, [foreach no genérico](./samples/non-generic-foreach.md).</span><span class="sxs-lookup"><span data-stu-id="db1bc-104">This topic discusses the architecture of one of the sample projects, [Non-Generic ForEach](./samples/non-generic-foreach.md).</span></span>  
  
## <a name="creating-the-custom-class"></a><span data-ttu-id="db1bc-105">Crear la clase personalizada</span><span class="sxs-lookup"><span data-stu-id="db1bc-105">Creating the custom class</span></span>  

 <span data-ttu-id="db1bc-106">Dado que la clase ForEach no genérica tendrá que programar actividades secundarias, será necesario que derive de <xref:System.Activities.NativeActivity>, ya que las actividades que derivan de <xref:System.Workflow.Activities.CodeActivity> no tienen esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="db1bc-106">Since the Non-Generic ForEach class will need to schedule child activities, it will need to derive from <xref:System.Activities.NativeActivity>, since activities that derive from <xref:System.Workflow.Activities.CodeActivity> do not have this functionality.</span></span>  
  
```csharp  
public sealed class ForEach : NativeActivity  
{
}
```  
  
 <span data-ttu-id="db1bc-107">La clase personalizada requiere que varios miembros almacenen datos que van a ser utilizados por la actividad y proporcionen funcionalidad para ejecutar las actividades secundarias de la actividad.</span><span class="sxs-lookup"><span data-stu-id="db1bc-107">The custom class requires several members to store data being used by the activity, and to provide functionality to execute the activity’s child activities.</span></span> <span data-ttu-id="db1bc-108">Estos miembros son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="db1bc-108">These members include:</span></span>  
  
- <span data-ttu-id="db1bc-109">`valueEnumerator`: clase <xref:System.Activities.Variable%601> no pública de tipo <xref:System.Collections.IEnumerator> que se utiliza para realizar iteraciones en la colección de elementos.</span><span class="sxs-lookup"><span data-stu-id="db1bc-109">`valueEnumerator`: The non-public <xref:System.Activities.Variable%601> of type <xref:System.Collections.IEnumerator> used to iterate over the collection of items.</span></span> <span data-ttu-id="db1bc-110">Este miembro es de tipo <xref:System.Activities.Variable%601> porque se utiliza internamente en la actividad, en lugar de un argumento o una propiedad pública, que se utilizarían si este objeto fuera a tener un origen externo a la actividad.</span><span class="sxs-lookup"><span data-stu-id="db1bc-110">This member is of type <xref:System.Activities.Variable%601> because it is used internally in the activity, rather than an argument or public property, which would be used if this object were to have an origin outside the activity.</span></span>  
  
- <span data-ttu-id="db1bc-111">`OnChildComplete`: propiedad <xref:System.Activities.CompletionCallback> pública que se ejecuta cuando se completa la ejecución de cada actividad secundaria.</span><span class="sxs-lookup"><span data-stu-id="db1bc-111">`OnChildComplete`: The public <xref:System.Activities.CompletionCallback> property that executes when each child completes execution.</span></span> <span data-ttu-id="db1bc-112">Este miembro se define como una propiedad CLR, ya que su valor no cambiará para las diferentes instancias de la actividad.</span><span class="sxs-lookup"><span data-stu-id="db1bc-112">This member is defined as a CLR property, since its value will not change for different instances of the activity.</span></span>  
  
- <span data-ttu-id="db1bc-113">`Values`: colección de entradas que se utilizan para las iteraciones de la actividad secundaria.</span><span class="sxs-lookup"><span data-stu-id="db1bc-113">`Values`: The collection of inputs used for the iterations of the child activity.</span></span> <span data-ttu-id="db1bc-114">Este miembro es de tipo <xref:System.Activities.InArgument%601>, ya que el origen de los datos es externo a la actividad, pero no se espera que el contenido de la colección cambie durante la ejecución de la actividad.</span><span class="sxs-lookup"><span data-stu-id="db1bc-114">This member is of type <xref:System.Activities.InArgument%601>, since the origin of the data is outside the activity, but the contents of the collection is not expected to change during the execution of the activity.</span></span> <span data-ttu-id="db1bc-115">Si la actividad necesitara que la funcionalidad cambiara el contenido de esta colección durante su ejecución (para agregar o quitar actividades, por ejemplo), este miembro se habría definido como <xref:System.Activities.ActivityAction>, y se habría evaluado cada vez que se hubiera tenido acceso a él, de modo que los cambios estuvieran disponibles para la actividad.</span><span class="sxs-lookup"><span data-stu-id="db1bc-115">If the activity needed the functionality to change the contents of this collection while the activity was executing (to add or remove activities, for instance), this member would have been defined as an <xref:System.Activities.ActivityAction>, which then would have been evaluated every time it was accessed, so that changes would be available to the activity.</span></span>  
  
- <span data-ttu-id="db1bc-116">`Body`: este miembro define la actividad que se va a ejecutar para cada elemento de la colección `Values`.</span><span class="sxs-lookup"><span data-stu-id="db1bc-116">`Body`: This member defines the activity to be executed for each item in the `Values` collection.</span></span> <span data-ttu-id="db1bc-117">Se define como <xref:System.Activities.ActivityAction> para que se evalúe cada vez que se tenga acceso a él.</span><span class="sxs-lookup"><span data-stu-id="db1bc-117">This member is defined as an <xref:System.Activities.ActivityAction> so that it is evaluated every time it is accessed.</span></span>  
  
- <span data-ttu-id="db1bc-118">`Execute`: este método utiliza los miembros no públicos `InternalExecute`, `OnForEachComplete` y `GetStateAndExecute` para programar la ejecución y asignar el controlador de finalización de la actividad secundaria definida en el miembro Body.</span><span class="sxs-lookup"><span data-stu-id="db1bc-118">`Execute`: This method uses the `InternalExecute`, `OnForEachComplete`, and `GetStateAndExecute` non-public members to schedule the execution and assign the completion handler of the child activity defined in the Body member.</span></span>  
  
- <span data-ttu-id="db1bc-119">`CacheMetadata`: este miembro proporciona al runtime la información que necesita para ejecutar la actividad.</span><span class="sxs-lookup"><span data-stu-id="db1bc-119">`CacheMetadata`: This member provides the runtime with the information it needs to execute the activity.</span></span> <span data-ttu-id="db1bc-120">De forma predeterminada, el método `CacheMetadata` de una actividad informará al runtime de todos los miembros públicos de la actividad, pero como esta actividad utiliza miembros privados para alguna funcionalidad, necesita informar al runtime de su existencia para que este los tenga en cuenta.</span><span class="sxs-lookup"><span data-stu-id="db1bc-120">By default, an activity’s `CacheMetadata` method will inform the runtime of all public members of the activity, but since this activity uses private members for some functionality, it needs to inform the runtime of their existence so that the runtime can be aware of them.</span></span> <span data-ttu-id="db1bc-121">En este caso, la función `CacheMetadata` se reemplaza para que se pueda tener acceso al miembro `valueEnumerator` privado.</span><span class="sxs-lookup"><span data-stu-id="db1bc-121">In this case, the `CacheMetadata` function is overridden so that the private `valueEnumerator` member can be accessed.</span></span> <span data-ttu-id="db1bc-122">Este miembro también crea un argumento para los valores de la actividad de modo que se puedan pasar a la actividad durante la ejecución.</span><span class="sxs-lookup"><span data-stu-id="db1bc-122">This member also creates an argument for the values for the activity so that they can be passed in to the activity during execution.</span></span>
