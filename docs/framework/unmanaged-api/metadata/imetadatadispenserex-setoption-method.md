---
title: IMetaDataDispenserEx::SetOption (Método)
ms.date: 03/30/2017
api_name:
- IMetaDataDispenserEx.SetOption
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- IMetaDataDispenserEx::SetOption
helpviewer_keywords:
- IMetaDataDispenserEx::SetOption method [.NET Framework metadata]
- SetOption method [.NET Framework metadata]
ms.assetid: 9f1c7ccd-7fb2-41d8-aa00-24b823376527
topic_type:
- apiref
ms.openlocfilehash: 4216658eb562c5c57b75c3c257cd8e53a7a34221
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/24/2020
ms.locfileid: "95700592"
---
# <a name="imetadatadispenserexsetoption-method"></a><span data-ttu-id="9f917-102">IMetaDataDispenserEx::SetOption (Método)</span><span class="sxs-lookup"><span data-stu-id="9f917-102">IMetaDataDispenserEx::SetOption Method</span></span>

<span data-ttu-id="9f917-103">Establece la opción especificada en un valor determinado para el ámbito de metadatos actual.</span><span class="sxs-lookup"><span data-stu-id="9f917-103">Sets the specified option to a given value for the current metadata scope.</span></span> <span data-ttu-id="9f917-104">La opción controla cómo se controlan las llamadas al ámbito de metadatos actual.</span><span class="sxs-lookup"><span data-stu-id="9f917-104">The option controls how calls to the current metadata scope are handled.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="9f917-105">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="9f917-105">Syntax</span></span>  
  
```cpp  
HRESULT SetOption (  
    [in] REFGUID optionId,
    [in] const VARIANT *pValue  
);  
```  
  
## <a name="parameters"></a><span data-ttu-id="9f917-106">Parámetros</span><span class="sxs-lookup"><span data-stu-id="9f917-106">Parameters</span></span>  

 `optionId`  
 <span data-ttu-id="9f917-107">de Un puntero a un GUID que especifica la opción que se va a establecer.</span><span class="sxs-lookup"><span data-stu-id="9f917-107">[in] A pointer to a GUID that specifies the option to be set.</span></span>  
  
 `pValue`  
 <span data-ttu-id="9f917-108">de Valor que se va a usar para establecer la opción.</span><span class="sxs-lookup"><span data-stu-id="9f917-108">[in] The value to use to set the option.</span></span> <span data-ttu-id="9f917-109">El tipo de este valor debe ser una variante del tipo de la opción especificada.</span><span class="sxs-lookup"><span data-stu-id="9f917-109">The type of this value must be a variant of the specified option's type.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="9f917-110">Comentarios</span><span class="sxs-lookup"><span data-stu-id="9f917-110">Remarks</span></span>  

 <span data-ttu-id="9f917-111">En la tabla siguiente se enumeran los GUID disponibles `optionId` a los que puede apuntar el parámetro y los valores válidos correspondientes para el `pValue` parámetro.</span><span class="sxs-lookup"><span data-stu-id="9f917-111">The following table lists the available GUIDs that the `optionId` parameter can point to and the corresponding valid values for the `pValue` parameter.</span></span>  
  
|<span data-ttu-id="9f917-112">GUID</span><span class="sxs-lookup"><span data-stu-id="9f917-112">GUID</span></span>|<span data-ttu-id="9f917-113">Descripción</span><span class="sxs-lookup"><span data-stu-id="9f917-113">Description</span></span>|<span data-ttu-id="9f917-114">`pValue` Parameter</span><span class="sxs-lookup"><span data-stu-id="9f917-114">`pValue` Parameter</span></span>|  
|----------|-----------------|------------------------|  
|<span data-ttu-id="9f917-115">MetaDataCheckDuplicatesFor</span><span class="sxs-lookup"><span data-stu-id="9f917-115">MetaDataCheckDuplicatesFor</span></span>|<span data-ttu-id="9f917-116">Controla qué elementos están comprobados en busca de duplicados.</span><span class="sxs-lookup"><span data-stu-id="9f917-116">Controls which items are checked for duplicates.</span></span> <span data-ttu-id="9f917-117">Cada vez que se llama a un método [IMetaDataEmit](imetadataemit-interface.md) que crea un nuevo elemento, puede pedir al método que compruebe si el elemento ya existe en el ámbito actual.</span><span class="sxs-lookup"><span data-stu-id="9f917-117">Each time you call an [IMetaDataEmit](imetadataemit-interface.md) method that creates a new item, you can ask the method to check whether the item already exists in the current scope.</span></span> <span data-ttu-id="9f917-118">Por ejemplo, puede comprobar la existencia de `mdMethodDef` elementos; en este caso, al llamar a [IMetaDataEmit::D efinemethod](imetadataemit-definemethod-method.md), comprobará que el método no existe aún en el ámbito actual.</span><span class="sxs-lookup"><span data-stu-id="9f917-118">For example, you can check for the existence of `mdMethodDef` items; in this case, when you call [IMetaDataEmit::DefineMethod](imetadataemit-definemethod-method.md), it will check that the method does not already exist in the current scope.</span></span> <span data-ttu-id="9f917-119">Esta comprobación utiliza la clave que identifica de forma única un método dado: tipo primario, nombre y firma.</span><span class="sxs-lookup"><span data-stu-id="9f917-119">This check uses the key that uniquely identifies a given method: parent type, name, and signature.</span></span>|<span data-ttu-id="9f917-120">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la enumeración [CorCheckDuplicatesFor (](corcheckduplicatesfor-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-120">Must be a variant of type UI4, and must contain a combination of the values of the [CorCheckDuplicatesFor](corcheckduplicatesfor-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="9f917-121">MetaDataRefToDefCheck</span><span class="sxs-lookup"><span data-stu-id="9f917-121">MetaDataRefToDefCheck</span></span>|<span data-ttu-id="9f917-122">Controla los elementos a los que se hace referencia que se convierten en definiciones.</span><span class="sxs-lookup"><span data-stu-id="9f917-122">Controls which referenced items are converted to definitions.</span></span> <span data-ttu-id="9f917-123">De forma predeterminada, el motor de metadatos optimizará el código convirtiendo un elemento al que se hace referencia en su definición si el elemento al que se hace referencia se define realmente en el ámbito actual.</span><span class="sxs-lookup"><span data-stu-id="9f917-123">By default, the metadata engine will optimize the code by converting a referenced item to its definition if the referenced item is actually defined in the current scope.</span></span>|<span data-ttu-id="9f917-124">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la enumeración [correftodefcheck (](correftodefcheck-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-124">Must be a variant of type UI4, and must contain a combination of the values of the [CorRefToDefCheck](correftodefcheck-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="9f917-125">MetaDataNotificationForTokenMovement</span><span class="sxs-lookup"><span data-stu-id="9f917-125">MetaDataNotificationForTokenMovement</span></span>|<span data-ttu-id="9f917-126">Controla qué reasignaciones de token se producen durante una combinación de metadatos genera devoluciones de llamada.</span><span class="sxs-lookup"><span data-stu-id="9f917-126">Controls which token remaps occurring during a metadata merge generate callbacks.</span></span> <span data-ttu-id="9f917-127">Use el método [IMetaDataEmit:: SetHandler](imetadataemit-sethandler-method.md) para establecer la interfaz [IMapToken](imaptoken-interface.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-127">Use the [IMetaDataEmit::SetHandler](imetadataemit-sethandler-method.md) method to establish your [IMapToken](imaptoken-interface.md) interface.</span></span>|<span data-ttu-id="9f917-128">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la enumeración [cornotificationfortokenmovement (](cornotificationfortokenmovement-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-128">Must be a variant of type UI4, and must contain a combination of the values of the [CorNotificationForTokenMovement](cornotificationfortokenmovement-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="9f917-129">MetaDataSetENC</span><span class="sxs-lookup"><span data-stu-id="9f917-129">MetaDataSetENC</span></span>|<span data-ttu-id="9f917-130">Controla el comportamiento de editar y continuar (ENC).</span><span class="sxs-lookup"><span data-stu-id="9f917-130">Controls the behavior of edit-and-continue (ENC).</span></span> <span data-ttu-id="9f917-131">Solo se puede establecer un modo de comportamiento a la vez.</span><span class="sxs-lookup"><span data-stu-id="9f917-131">Only one mode of behavior can be set at a time.</span></span>|<span data-ttu-id="9f917-132">Debe ser una variante de tipo UI4 y debe contener un valor de la enumeración [corsetenc (](corsetenc-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-132">Must be a variant of type UI4, and must contain a value of the [CorSetENC](corsetenc-enumeration.md) enumeration.</span></span> <span data-ttu-id="9f917-133">El valor no es una máscara de máscara.</span><span class="sxs-lookup"><span data-stu-id="9f917-133">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="9f917-134">MetaDataErrorIfEmitOutOfOrder</span><span class="sxs-lookup"><span data-stu-id="9f917-134">MetaDataErrorIfEmitOutOfOrder</span></span>|<span data-ttu-id="9f917-135">Controla los errores de emisión desordenados que generan devoluciones de llamada.</span><span class="sxs-lookup"><span data-stu-id="9f917-135">Controls which emitted-out-of-order errors generate callbacks.</span></span> <span data-ttu-id="9f917-136">La emisión de metadatos fuera de orden no es grave; sin embargo, si se emiten metadatos en un orden que se favorece mediante el motor de metadatos, los metadatos son más compactos y, por lo tanto, se pueden buscar de forma más eficaz.</span><span class="sxs-lookup"><span data-stu-id="9f917-136">Emitting metadata out of order is not fatal; however, if you emit metadata in an order that is favored by the metadata engine, the metadata is more compact and therefore can be more efficiently searched.</span></span> <span data-ttu-id="9f917-137">Use el `IMetaDataEmit::SetHandler` método para establecer la interfaz [imetadataerror (](imetadataerror-interface.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-137">Use the `IMetaDataEmit::SetHandler` method to establish your [IMetaDataError](imetadataerror-interface.md) interface.</span></span>|<span data-ttu-id="9f917-138">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la enumeración [corerrorifemitoutoforder (](corerrorifemitoutoforder-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-138">Must be a variant of type UI4, and must contain a combination of the values of the [CorErrorIfEmitOutOfOrder](corerrorifemitoutoforder-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="9f917-139">MetaDataImportOption</span><span class="sxs-lookup"><span data-stu-id="9f917-139">MetaDataImportOption</span></span>|<span data-ttu-id="9f917-140">Controla qué tipos de elementos que se eliminaron durante un ENC se recuperan mediante un enumerador.</span><span class="sxs-lookup"><span data-stu-id="9f917-140">Controls which kinds of items that were deleted during an ENC are retrieved by an enumerator.</span></span>|<span data-ttu-id="9f917-141">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la enumeración de [enumeración corimportoptions (](corimportoptions-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-141">Must be a variant of type UI4, and must contain a combination of the values of the [CorImportOptions Enumeration](corimportoptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="9f917-142">MetaDataThreadSafetyOptions</span><span class="sxs-lookup"><span data-stu-id="9f917-142">MetaDataThreadSafetyOptions</span></span>|<span data-ttu-id="9f917-143">Controla si el motor de metadatos obtiene bloqueos de lectura/escritura, lo que garantiza la seguridad para subprocesos.</span><span class="sxs-lookup"><span data-stu-id="9f917-143">Controls whether the metadata engine obtains reader/writer locks, thereby ensuring thread safety.</span></span> <span data-ttu-id="9f917-144">De forma predeterminada, el motor supone que el acceso es de subproceso único por parte del llamador, por lo que no se obtiene ningún bloqueo.</span><span class="sxs-lookup"><span data-stu-id="9f917-144">By default, the engine assumes that access is single-threaded by the caller, so no locks are obtained.</span></span> <span data-ttu-id="9f917-145">Los clientes son responsables de mantener la sincronización de subprocesos adecuada cuando se usa la API de metadatos.</span><span class="sxs-lookup"><span data-stu-id="9f917-145">Clients are responsible for maintaining proper thread synchronization when using the metadata API.</span></span>|<span data-ttu-id="9f917-146">Debe ser una variante de tipo UI4 y debe contener un valor de la enumeración [corthreadsafetyoptions (](corthreadsafetyoptions-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-146">Must be a variant of type UI4, and must contain a value of the [CorThreadSafetyOptions](corthreadsafetyoptions-enumeration.md) enumeration.</span></span> <span data-ttu-id="9f917-147">El valor no es una máscara de máscara.</span><span class="sxs-lookup"><span data-stu-id="9f917-147">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="9f917-148">MetaDataGenerateTCEAdapters</span><span class="sxs-lookup"><span data-stu-id="9f917-148">MetaDataGenerateTCEAdapters</span></span>|<span data-ttu-id="9f917-149">Controla si el importador de la biblioteca de tipos debe generar los adaptadores de eventos estrechamente acoplados (TCE) para los contenedores de puntos de conexión COM.</span><span class="sxs-lookup"><span data-stu-id="9f917-149">Controls whether the type library importer should generate the tightly coupled event (TCE) adapters for COM connection point containers.</span></span>|<span data-ttu-id="9f917-150">Debe ser una variante de tipo BOOL.</span><span class="sxs-lookup"><span data-stu-id="9f917-150">Must be a variant of type BOOL.</span></span> <span data-ttu-id="9f917-151">Si `pValue` se establece en `true` , el importador de la biblioteca de tipos genera los adaptadores de TCE.</span><span class="sxs-lookup"><span data-stu-id="9f917-151">If `pValue` is set to `true`, the type library importer generates the TCE adapters.</span></span>|  
|<span data-ttu-id="9f917-152">MetaDataTypeLibImportNamespace</span><span class="sxs-lookup"><span data-stu-id="9f917-152">MetaDataTypeLibImportNamespace</span></span>|<span data-ttu-id="9f917-153">Especifica un espacio de nombres no predeterminado para la biblioteca de tipos que se va a importar.</span><span class="sxs-lookup"><span data-stu-id="9f917-153">Specifies a non-default namespace for the type library that is being imported.</span></span>|<span data-ttu-id="9f917-154">Debe ser un valor null o una variante de tipo BSTR.</span><span class="sxs-lookup"><span data-stu-id="9f917-154">Must be either a null value or a variant of type BSTR.</span></span> <span data-ttu-id="9f917-155">Si `pValue` es un valor null, el espacio de nombres actual se establece en NULL; de lo contrario, el espacio de nombres actual se establece en la cadena que se mantiene en el tipo BSTR de la variante.</span><span class="sxs-lookup"><span data-stu-id="9f917-155">If `pValue` is a null value, the current namespace is set to null; otherwise, the current namespace is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="9f917-156">MetaDataLinkerOptions</span><span class="sxs-lookup"><span data-stu-id="9f917-156">MetaDataLinkerOptions</span></span>|<span data-ttu-id="9f917-157">Controla si el vinculador debe generar un ensamblado o un archivo de módulo de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="9f917-157">Controls whether the linker should generate an assembly or a .NET Framework module file.</span></span>|<span data-ttu-id="9f917-158">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la enumeración [corlinkeroptions (](corlinkeroptions-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-158">Must be a variant of type UI4, and must contain a combination of the values of the [CorLinkerOptions](corlinkeroptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="9f917-159">MetaDataRuntimeVersion</span><span class="sxs-lookup"><span data-stu-id="9f917-159">MetaDataRuntimeVersion</span></span>|<span data-ttu-id="9f917-160">Especifica la versión de la Common Language Runtime en la que se compiló esta imagen.</span><span class="sxs-lookup"><span data-stu-id="9f917-160">Specifies the version of the common language runtime against which this image was built.</span></span> <span data-ttu-id="9f917-161">La versión se almacena como una cadena, como "v 1.0.3705".</span><span class="sxs-lookup"><span data-stu-id="9f917-161">The version is stored as a string, such as "v1.0.3705".</span></span>|<span data-ttu-id="9f917-162">Debe ser un valor null, un valor de VT_EMPTY o una variante de tipo BSTR.</span><span class="sxs-lookup"><span data-stu-id="9f917-162">Must be a null value, a VT_EMPTY value, or a variant of type BSTR.</span></span> <span data-ttu-id="9f917-163">Si `pValue` es null, la versión en tiempo de ejecución se establece en NULL.</span><span class="sxs-lookup"><span data-stu-id="9f917-163">If `pValue` is null, the runtime version is set to null.</span></span> <span data-ttu-id="9f917-164">Si `pValue` es VT_EMPTY, la versión se establece en un valor predeterminado, que se extrae de la versión de Mscorwks.dll en la que se está ejecutando el código de metadatos.</span><span class="sxs-lookup"><span data-stu-id="9f917-164">If `pValue` is VT_EMPTY, the version is set to a default value, which is drawn from the version of Mscorwks.dll within which the metadata code is running.</span></span> <span data-ttu-id="9f917-165">De lo contrario, la versión en tiempo de ejecución se establece en la cadena que se mantiene en el tipo BSTR de la variante.</span><span class="sxs-lookup"><span data-stu-id="9f917-165">Otherwise, the runtime version is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="9f917-166">MetaDataMergerOptions</span><span class="sxs-lookup"><span data-stu-id="9f917-166">MetaDataMergerOptions</span></span>|<span data-ttu-id="9f917-167">Especifica las opciones para combinar los metadatos.</span><span class="sxs-lookup"><span data-stu-id="9f917-167">Specifies options for merging metadata.</span></span>|<span data-ttu-id="9f917-168">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la `MergeFlags` enumeración, que se describe en el archivo CorHdr. h.</span><span class="sxs-lookup"><span data-stu-id="9f917-168">Must be a variant of type UI4, and must contain a combination of the values of the `MergeFlags` enumeration, which is described in the CorHdr.h file.</span></span>|  
|<span data-ttu-id="9f917-169">MetaDataPreserveLocalRefs</span><span class="sxs-lookup"><span data-stu-id="9f917-169">MetaDataPreserveLocalRefs</span></span>|<span data-ttu-id="9f917-170">Deshabilita la optimización de referencias locales en definiciones.</span><span class="sxs-lookup"><span data-stu-id="9f917-170">Disables optimizing local references into definitions.</span></span>|<span data-ttu-id="9f917-171">Debe contener una combinación de los valores de la enumeración [corlocalrefpreservation (](corlocalrefpreservation-enumeration.md) .</span><span class="sxs-lookup"><span data-stu-id="9f917-171">Must contain a combination of the values of the [CorLocalRefPreservation](corlocalrefpreservation-enumeration.md) enumeration.</span></span>|  
  
## <a name="requirements"></a><span data-ttu-id="9f917-172">Requisitos</span><span class="sxs-lookup"><span data-stu-id="9f917-172">Requirements</span></span>  

 <span data-ttu-id="9f917-173">**Plataforma:** Consulte [requisitos del sistema](../../get-started/system-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="9f917-173">**Platform:** See [System Requirements](../../get-started/system-requirements.md).</span></span>  
  
 <span data-ttu-id="9f917-174">**Encabezado:** Cor. h</span><span class="sxs-lookup"><span data-stu-id="9f917-174">**Header:** Cor.h</span></span>  
  
 <span data-ttu-id="9f917-175">**Biblioteca:** Se usa como un recurso en MsCorEE.dll</span><span class="sxs-lookup"><span data-stu-id="9f917-175">**Library:** Used as a resource in MsCorEE.dll</span></span>  
  
 <span data-ttu-id="9f917-176">**.NET Framework versiones:**[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span><span class="sxs-lookup"><span data-stu-id="9f917-176">**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9f917-177">Consulte también</span><span class="sxs-lookup"><span data-stu-id="9f917-177">See also</span></span>

- [<span data-ttu-id="9f917-178">IMetaDataDispenserEx (Interfaz)</span><span class="sxs-lookup"><span data-stu-id="9f917-178">IMetaDataDispenserEx Interface</span></span>](imetadatadispenserex-interface.md)
- [<span data-ttu-id="9f917-179">IMetaDataDispenser (Interfaz)</span><span class="sxs-lookup"><span data-stu-id="9f917-179">IMetaDataDispenser Interface</span></span>](imetadatadispenser-interface.md)
