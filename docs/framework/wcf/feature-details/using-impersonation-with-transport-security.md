---
title: Utilización de la suplantación con la seguridad de transporte
ms.date: 03/30/2017
ms.assetid: 426df8cb-6337-4262-b2c0-b96c2edf21a9
ms.openlocfilehash: 14914bc65d5033c54640e06b79713ea1871daf18
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96289508"
---
# <a name="using-impersonation-with-transport-security"></a><span data-ttu-id="d32a7-102">Utilización de la suplantación con la seguridad de transporte</span><span class="sxs-lookup"><span data-stu-id="d32a7-102">Using Impersonation with Transport Security</span></span>

<span data-ttu-id="d32a7-103">La *suplantación* es la capacidad de una aplicación de servidor de asumir la identidad del cliente.</span><span class="sxs-lookup"><span data-stu-id="d32a7-103">*Impersonation* is the ability of a server application to take on the identity of the client.</span></span> <span data-ttu-id="d32a7-104">Es común que los servicios utilicen la suplantación al validar el acceso a los recursos.</span><span class="sxs-lookup"><span data-stu-id="d32a7-104">It is common for services to use impersonation when validating access to resources.</span></span> <span data-ttu-id="d32a7-105">La aplicación de servidor se ejecuta utilizando una cuenta de servicio, pero cuando el servidor acepta una conexión de cliente, suplanta al cliente para que se realicen comprobaciones de acceso utilizando las credenciales del cliente.</span><span class="sxs-lookup"><span data-stu-id="d32a7-105">The server application runs using a service account, but when the server accepts a client connection, it impersonates the client so that access checks are performed using the client's credentials.</span></span> <span data-ttu-id="d32a7-106">La seguridad de transporte es un mecanismo para pasar credenciales y proteger la comunicación mediante esas credenciales.</span><span class="sxs-lookup"><span data-stu-id="d32a7-106">Transport security is a mechanism both for passing credentials and securing communication using those credentials.</span></span> <span data-ttu-id="d32a7-107">En este tema se describe el uso de la seguridad de transporte en Windows Communication Foundation (WCF) con la característica de suplantación.</span><span class="sxs-lookup"><span data-stu-id="d32a7-107">This topic describes using transport security in Windows Communication Foundation (WCF) with the impersonation feature.</span></span> <span data-ttu-id="d32a7-108">Para obtener más información sobre la suplantación mediante la seguridad de mensajes, vea [delegación y suplantación](delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="d32a7-108">For more information about impersonation using message security, see [Delegation and Impersonation](delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="five-impersonation-levels"></a><span data-ttu-id="d32a7-109">Cinco niveles de suplantación</span><span class="sxs-lookup"><span data-stu-id="d32a7-109">Five Impersonation Levels</span></span>  

 <span data-ttu-id="d32a7-110">La seguridad de transporte utiliza cinco niveles de suplantación, como se describe en la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="d32a7-110">Transport security makes use of five levels of impersonation, as described in the following table.</span></span>  
  
|<span data-ttu-id="d32a7-111">Nivel de suplantación</span><span class="sxs-lookup"><span data-stu-id="d32a7-111">Impersonation level</span></span>|<span data-ttu-id="d32a7-112">Descripción</span><span class="sxs-lookup"><span data-stu-id="d32a7-112">Description</span></span>|  
|-------------------------|-----------------|  
|<span data-ttu-id="d32a7-113">None</span><span class="sxs-lookup"><span data-stu-id="d32a7-113">None</span></span>|<span data-ttu-id="d32a7-114">La aplicación de servidor no intenta suplantar al cliente.</span><span class="sxs-lookup"><span data-stu-id="d32a7-114">The server application does not attempt to impersonate the client.</span></span>|  
|<span data-ttu-id="d32a7-115">Anónimas</span><span class="sxs-lookup"><span data-stu-id="d32a7-115">Anonymous</span></span>|<span data-ttu-id="d32a7-116">La aplicación de servidor puede realizar comprobaciones de acceso frente a las credenciales de cliente, pero no recibe ninguna información sobre la identidad del cliente.</span><span class="sxs-lookup"><span data-stu-id="d32a7-116">The server application can perform access checks against the client's credentials, but does not receive any information about the client's identity.</span></span> <span data-ttu-id="d32a7-117">Este nivel de suplantación solo es significativo para la comunicación en equipo, como, por ejemplo, en canalizaciones con nombre.</span><span class="sxs-lookup"><span data-stu-id="d32a7-117">This impersonation level is meaningful only for on-machine communication, such as named pipes.</span></span> <span data-ttu-id="d32a7-118">Al utilizar `Anonymous` con una conexión remota, se promueve el nivel de suplantación a identificar.</span><span class="sxs-lookup"><span data-stu-id="d32a7-118">Using `Anonymous` with a remote connection promotes the impersonation level to Identify.</span></span>|  
|<span data-ttu-id="d32a7-119">Identificar</span><span class="sxs-lookup"><span data-stu-id="d32a7-119">Identify</span></span>|<span data-ttu-id="d32a7-120">La aplicación de servidor conoce la identidad del cliente y puede realizar validación de acceso frente a las credenciales del cliente, pero no puede suplantar al cliente.</span><span class="sxs-lookup"><span data-stu-id="d32a7-120">The server application knows the client's identity and can perform access validation against the client's credentials, but cannot impersonate the client.</span></span> <span data-ttu-id="d32a7-121">Identificar es el nivel de suplantación predeterminado que se usa con las credenciales de SSPI en WCF a menos que el proveedor de tokens proporcione un nivel de suplantación diferente.</span><span class="sxs-lookup"><span data-stu-id="d32a7-121">Identify is the default impersonation level used with SSPI credentials in WCF unless the token provider provides a different impersonation level.</span></span>|  
|<span data-ttu-id="d32a7-122">Impersonate</span><span class="sxs-lookup"><span data-stu-id="d32a7-122">Impersonate</span></span>|<span data-ttu-id="d32a7-123">La aplicación de servidor puede obtener acceso a recursos en el equipo del servidor como el cliente además de realizar las comprobaciones de acceso.</span><span class="sxs-lookup"><span data-stu-id="d32a7-123">The server application can access resources on the server machine as the client in addition to performing access checks.</span></span> <span data-ttu-id="d32a7-124">La aplicación de servidor no puede tener acceso a los recursos en los equipos remotos utilizando la identidad del cliente porque el token suplantado no tiene credenciales de red.</span><span class="sxs-lookup"><span data-stu-id="d32a7-124">The server application cannot access resources on remote machines using the client's identity because the impersonated token does not have network credentials</span></span>|  
|<span data-ttu-id="d32a7-125">Delegado</span><span class="sxs-lookup"><span data-stu-id="d32a7-125">Delegate</span></span>|<span data-ttu-id="d32a7-126">Además de tener las mismas funciones que `Impersonate`, el nivel de suplantación de Delegar también permite a la aplicación de servidor obtener acceso a los recursos en los equipos remotos utilizando la identidad del cliente y pasar la identidad a otras aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d32a7-126">In addition to having the same capabilities as `Impersonate`, the Delegate impersonation level also enables the server application to access resources on remote machines using the client's identity and to pass the identity to other applications.</span></span><br /><br /> <span data-ttu-id="d32a7-127">**Importante** La cuenta de dominio del servidor debe estar marcada como de confianza para la delegación en el controlador de dominio para usar estas características adicionales.</span><span class="sxs-lookup"><span data-stu-id="d32a7-127">**Important** The server domain account must be marked as trusted for delegation on the domain controller to use these additional features.</span></span> <span data-ttu-id="d32a7-128">Este nivel de suplantación no se puede utilizar con cuentas de dominio de cliente marcadas como sensibles.</span><span class="sxs-lookup"><span data-stu-id="d32a7-128">This level of impersonation cannot be used with client domain accounts marked as sensitive.</span></span>|  
  
 <span data-ttu-id="d32a7-129">Los niveles que se usan con mayor frecuencia con la seguridad de transporte son `Identify` y `Impersonate` .</span><span class="sxs-lookup"><span data-stu-id="d32a7-129">The levels most commonly used with transport security are `Identify` and `Impersonate`.</span></span> <span data-ttu-id="d32a7-130">Los niveles `None` y `Anonymous` no se recomiendan para el uso general y muchos transportes no permiten el uso de esos niveles con autenticación.</span><span class="sxs-lookup"><span data-stu-id="d32a7-130">The levels `None` and `Anonymous` are not recommended for typical use, and many transports do not support using those levels with authentication.</span></span> <span data-ttu-id="d32a7-131">El nivel `Delegate` es una característica eficaz que se debe utilizar con cuidado.</span><span class="sxs-lookup"><span data-stu-id="d32a7-131">The `Delegate` level is a powerful feature that should be used with care.</span></span> <span data-ttu-id="d32a7-132">Solo se debe proporcionar el permiso de delegación de credenciales a las aplicaciones de servidor de confianza.</span><span class="sxs-lookup"><span data-stu-id="d32a7-132">Only trusted server applications should be given the permission to delegate credentials.</span></span>  
  
 <span data-ttu-id="d32a7-133">El uso de la suplantación en los niveles `Impersonate` o `Delegate` exige que la aplicación de servidor tenga el privilegio `SeImpersonatePrivilege`.</span><span class="sxs-lookup"><span data-stu-id="d32a7-133">Using impersonation at the `Impersonate` or `Delegate` levels requires the server application to have the `SeImpersonatePrivilege` privilege.</span></span> <span data-ttu-id="d32a7-134">Una aplicación tiene de forma predeterminada este privilegio si se está ejecutando en una cuenta del grupo Administradores o en una cuenta con un SID de Servicio (servicio de red, servicio local o sistema local).</span><span class="sxs-lookup"><span data-stu-id="d32a7-134">An application has this privilege by default if it is running on an account in the Administrators group or on an account with a Service SID (Network Service, Local Service, or Local System).</span></span> <span data-ttu-id="d32a7-135">La suplantación no requiere autenticación mutua del cliente y el servidor.</span><span class="sxs-lookup"><span data-stu-id="d32a7-135">Impersonation does not require mutual authentication of the client and server.</span></span> <span data-ttu-id="d32a7-136">Algunos esquemas de autenticación que admiten la suplantación, como NTLM, no se pueden utilizar con autenticación mutua.</span><span class="sxs-lookup"><span data-stu-id="d32a7-136">Some authentication schemes that support impersonation, such as NTLM, cannot be used with mutual authentication.</span></span>  
  
## <a name="transport-specific-issues-with-impersonation"></a><span data-ttu-id="d32a7-137">Problemas específicos del transporte con suplantación</span><span class="sxs-lookup"><span data-stu-id="d32a7-137">Transport-Specific Issues with Impersonation</span></span>  

 <span data-ttu-id="d32a7-138">La elección de un transporte en WCF afecta a las posibles opciones de suplantación.</span><span class="sxs-lookup"><span data-stu-id="d32a7-138">The choice of a transport in WCF affects the possible choices for impersonation.</span></span> <span data-ttu-id="d32a7-139">En esta sección se describen los problemas que afectan a los transportes HTTP y de canalización con nombre estándar en WCF.</span><span class="sxs-lookup"><span data-stu-id="d32a7-139">This section describes issues affecting the standard HTTP and named pipe transports in WCF.</span></span> <span data-ttu-id="d32a7-140">Los transportes personalizados tienen sus propias restricciones sobre la compatibilidad con la suplantación.</span><span class="sxs-lookup"><span data-stu-id="d32a7-140">Custom transports have their own restrictions on support for impersonation.</span></span>  
  
### <a name="named-pipe-transport"></a><span data-ttu-id="d32a7-141">Transporte de canalización con nombre</span><span class="sxs-lookup"><span data-stu-id="d32a7-141">Named Pipe Transport</span></span>  

 <span data-ttu-id="d32a7-142">Los elementos siguientes se utilizan con el transporte de canalización con nombre:</span><span class="sxs-lookup"><span data-stu-id="d32a7-142">The following items are used with the named pipe transport:</span></span>  
  
- <span data-ttu-id="d32a7-143">El transporte de canalización con nombre solo está pensado para su uso en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="d32a7-143">The named pipe transport is intended for use only on the local machine.</span></span> <span data-ttu-id="d32a7-144">El transporte de canalización con nombre de WCF no permite explícitamente las conexiones entre equipos.</span><span class="sxs-lookup"><span data-stu-id="d32a7-144">The named pipe transport in WCF explicitly disallows cross-machine connections.</span></span>  
  
- <span data-ttu-id="d32a7-145">Las canalizaciones con nombre no se pueden utilizar con `Impersonate` o el nivel de suplantación `Delegate`.</span><span class="sxs-lookup"><span data-stu-id="d32a7-145">Named pipes cannot be used with the `Impersonate` or `Delegate` impersonation level.</span></span> <span data-ttu-id="d32a7-146">La canalización con nombre no puede exigir la garantía en equipo en estos niveles de suplantación.</span><span class="sxs-lookup"><span data-stu-id="d32a7-146">The named pipe cannot enforce the on-machine guarantee at these impersonation levels.</span></span>  
  
 <span data-ttu-id="d32a7-147">Para obtener más información acerca de las canalizaciones con nombre, vea [elegir un transporte](choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="d32a7-147">For more information about named pipes, see [Choosing a Transport](choosing-a-transport.md).</span></span>  
  
### <a name="http-transport"></a><span data-ttu-id="d32a7-148">Transporte HTTP</span><span class="sxs-lookup"><span data-stu-id="d32a7-148">HTTP Transport</span></span>  

 <span data-ttu-id="d32a7-149">Los enlaces que utilizan el transporte HTTP ( <xref:System.ServiceModel.WSHttpBinding> y <xref:System.ServiceModel.BasicHttpBinding> ) admiten varios esquemas de autenticación, como se explica en [Understanding http Authentication](understanding-http-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="d32a7-149">The bindings that use the HTTP transport (<xref:System.ServiceModel.WSHttpBinding> and <xref:System.ServiceModel.BasicHttpBinding>) support several authentication schemes, as explained in [Understanding HTTP Authentication](understanding-http-authentication.md).</span></span> <span data-ttu-id="d32a7-150">El nivel de suplantación admitido depende del esquema de autenticación.</span><span class="sxs-lookup"><span data-stu-id="d32a7-150">The impersonation level supported depends on the authentication scheme.</span></span> <span data-ttu-id="d32a7-151">Los elementos siguientes se utilizan con el transporte HTTP:</span><span class="sxs-lookup"><span data-stu-id="d32a7-151">The following items are used with the HTTP transport:</span></span>  
  
- <span data-ttu-id="d32a7-152">El esquema de autenticación `Anonymous` omite la suplantación.</span><span class="sxs-lookup"><span data-stu-id="d32a7-152">The `Anonymous` authentication scheme ignores impersonation.</span></span>  
  
- <span data-ttu-id="d32a7-153">El `Basic` esquema de autenticación solo admite el `Delegate` nivel.</span><span class="sxs-lookup"><span data-stu-id="d32a7-153">The `Basic` authentication scheme supports only the `Delegate` level.</span></span> <span data-ttu-id="d32a7-154">Todos los niveles de suplantación inferiores se actualizan.</span><span class="sxs-lookup"><span data-stu-id="d32a7-154">All lower impersonation levels are upgraded.</span></span>  
  
- <span data-ttu-id="d32a7-155">El esquema de autenticación `Digest` solo admite los niveles `Impersonate` y `Delegate`.</span><span class="sxs-lookup"><span data-stu-id="d32a7-155">The `Digest` authentication scheme supports only the `Impersonate` and `Delegate` levels.</span></span>  
  
- <span data-ttu-id="d32a7-156">El esquema de autenticación `NTLM`, que se puede seleccionar directamente o mediante negociación, solo admite el nivel `Delegate` en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="d32a7-156">The `NTLM` authentication scheme, selectable either directly or through negotiation, supports only the `Delegate` level on the local machine.</span></span>  
  
- <span data-ttu-id="d32a7-157">El esquema de autenticación Kerberos, que solo se puede seleccionar mediante negociación, puede utilizarse con cualquier nivel de suplantación admitido.</span><span class="sxs-lookup"><span data-stu-id="d32a7-157">The Kerberos authentication scheme, which can only be selected through negotiation, can be used with any supported impersonation level.</span></span>  
  
 <span data-ttu-id="d32a7-158">Para obtener más información acerca del transporte HTTP, consulte [elección de un transporte](choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="d32a7-158">For more information about the HTTP transport, see [Choosing a Transport](choosing-a-transport.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d32a7-159">Vea también</span><span class="sxs-lookup"><span data-stu-id="d32a7-159">See also</span></span>

- [<span data-ttu-id="d32a7-160">Delegación y suplantación</span><span class="sxs-lookup"><span data-stu-id="d32a7-160">Delegation and Impersonation</span></span>](delegation-and-impersonation-with-wcf.md)
- [<span data-ttu-id="d32a7-161">Autorización</span><span class="sxs-lookup"><span data-stu-id="d32a7-161">Authorization</span></span>](authorization-in-wcf.md)
- [<span data-ttu-id="d32a7-162">Procedimiento para suplantar a un cliente en un servicio</span><span class="sxs-lookup"><span data-stu-id="d32a7-162">How to: Impersonate a Client on a Service</span></span>](../how-to-impersonate-a-client-on-a-service.md)
- [<span data-ttu-id="d32a7-163">Introducción a la autenticación HTTP</span><span class="sxs-lookup"><span data-stu-id="d32a7-163">Understanding HTTP Authentication</span></span>](understanding-http-authentication.md)
