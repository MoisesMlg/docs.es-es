---
title: Uso compartido de puertos Net.TCP
description: Obtenga información sobre un protocolo basado en TCP para la comunicación de alto rendimiento y el servicio que permite compartir puertos entre varios procesos de usuario en WCF.
ms.date: 03/30/2017
helpviewer_keywords:
- port activation [WCF]
- port sharing [WCF]
ms.assetid: f13692ee-a179-4439-ae72-50db9534eded
ms.openlocfilehash: 37e2c1de4516cbde58970db685422c5c65e25fb3
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96248102"
---
# <a name="nettcp-port-sharing"></a><span data-ttu-id="f3ab3-103">Uso compartido de puertos Net.TCP</span><span class="sxs-lookup"><span data-stu-id="f3ab3-103">Net.TCP Port Sharing</span></span>

<span data-ttu-id="f3ab3-104">Windows Communication Foundation (WCF) proporciona un nuevo protocolo de red basado en TCP (net. TCP://) para la comunicación de alto rendimiento.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-104">Windows Communication Foundation (WCF) provides a new TCP-based network protocol (net.tcp://) for high-performance communication.</span></span> <span data-ttu-id="f3ab3-105">WCF también introduce un nuevo componente del sistema, el servicio de uso compartido de puertos net. TCP que permite compartir puertos net. TCP entre varios procesos de usuario.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-105">WCF also introduces a new system component, the Net.TCP Port Sharing Service that enables net.tcp ports to be shared across multiple user processes.</span></span>  
  
## <a name="background-and-motivation"></a><span data-ttu-id="f3ab3-106">Contexto y motivación</span><span class="sxs-lookup"><span data-stu-id="f3ab3-106">Background and Motivation</span></span>  

 <span data-ttu-id="f3ab3-107">Cuando se introdujo el protocolo TCP/IP por primera vez, solo un número pequeño de protocolos de aplicación lo emplearon.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-107">When the TCP/IP protocol was first introduced, only a small number of application protocols made use of it.</span></span> <span data-ttu-id="f3ab3-108">TCP/IP utilizaba números de puertos para diferenciar entre aplicaciones asignando un número de puerto de 16 bits único para cada protocolo de aplicación.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-108">TCP/IP used port numbers to differentiate between applications by assigning a unique 16-bit port number to each application protocol.</span></span> <span data-ttu-id="f3ab3-109">Por ejemplo, el tráfico de HTTP hoy está normalizado para que utilice el puerto TCP 80, SMTP utiliza el puerto TCP 25 y el FTP utiliza los puertos TCP 20 y 21.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-109">For example, HTTP traffic today is standardized to use TCP port 80, SMTP uses TCP port 25, and FTP uses TCP ports 20 and 21.</span></span> <span data-ttu-id="f3ab3-110">Otras aplicaciones que utilicen TCP como transporte pueden elegir otro número de puerto disponible, por convención o a través de estandarización formal.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-110">Other applications using TCP as a transport can choose another available port number, either by convention or through formal standardization.</span></span>  
  
 <span data-ttu-id="f3ab3-111">El uso de números de puerto para distinguir entre aplicaciones provocaba problemas de seguridad.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-111">Using port numbers to distinguish between applications had security problems.</span></span> <span data-ttu-id="f3ab3-112">Los firewalls generalmente se configuran para bloquear el tráfico TCP en todos los puertos salvo unos puntos de entrada conocidos, así que implementar una aplicación que utiliza un puerto no estándar es, a menudo, complicado o imposible, debido a la presencia de firewalls personales y corporativos.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-112">Firewalls are generally configured to block TCP traffic on all ports except for a few well-known entry points, so deploying an application that uses a non-standard port is often complicated or even impossible due to the presence of corporate and personal firewalls.</span></span> <span data-ttu-id="f3ab3-113">Las aplicaciones que pueden comunicarse sobre puertos estándar bien conocidos que ya están permitidos, reducen la superficie de ataque externo.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-113">Applications that can communicate over standard, well-known ports that are already permitted, reduce the external attack surface.</span></span> <span data-ttu-id="f3ab3-114">Muchas aplicaciones de red utilizan el protocolo HTTP porque la mayoría de los firewalls se configuran de forma predeterminada para permitir el tráfico en el puerto TCP 80.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-114">Many network applications make use of the HTTP protocol because most firewalls are configured by default to allow traffic on TCP port 80.</span></span>  
  
 <span data-ttu-id="f3ab3-115">El modelo HTTP.SYS en el que el tráfico de muchas aplicaciones HTTP diferentes se multiplexa hacia un único puerto TCP se ha vuelto un estándar en la plataforma de Windows.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-115">The HTTP.SYS model in which traffic for many different HTTP applications is multiplexed onto a single TCP port has become standard on the Windows platform.</span></span> <span data-ttu-id="f3ab3-116">Esto proporciona un punto común de control para los administradores del firewall, al tiempo que permite a los desarrolladores de aplicaciones minimizar el costo de implementación de crear nuevas aplicaciones que pueden utilizar la red.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-116">This provides a common point of control for firewall administrators while allowing application developers to minimize the deployment cost of building new applications that can make use of the network.</span></span>  
  
 <span data-ttu-id="f3ab3-117">La capacidad de compartir puertos en varias aplicaciones HTTP ha sido durante mucho tiempo una característica de Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="f3ab3-117">The ability to share ports across multiple HTTP applications has long been a feature of Internet Information Services (IIS).</span></span> <span data-ttu-id="f3ab3-118">Sin embargo, solo era con la introducción de HTTP.SYS (el agente de escucha del protocolo HTTP de modo kernel) con IIS 6,0 que esta infraestructura se generalizaba por completo.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-118">However, it was only with the introduction of HTTP.SYS (the kernel-mode HTTP protocol listener) with IIS 6.0 that this infrastructure was fully generalized.</span></span> <span data-ttu-id="f3ab3-119">En efecto, HTTP.SYS permite a procesos de usuario arbitrarios compartir los puertos TCP dedicados al tráfico de HTTP.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-119">In effect, HTTP.SYS allows arbitrary user processes to share the TCP ports dedicated to HTTP traffic.</span></span> <span data-ttu-id="f3ab3-120">Esta función permite que muchas aplicaciones HTTP coexistan en el mismo equipo físico en procesos aislados y separados mientras comparten la infraestructura de red requerida para enviar y recibir tráfico a través del puerto TCP 80.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-120">This capability allows many HTTP applications to coexist on the same physical machine in separate, isolated processes while sharing the network infrastructure required to send and receive traffic over TCP port 80.</span></span> <span data-ttu-id="f3ab3-121">El servicio de uso compartido de puertos Net.TCP permite el mismo tipo de uso compartido de puertos para las aplicaciones de net.tcp.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-121">The Net.TCP Port Sharing Service enables the same type of port sharing for net.tcp applications.</span></span>  
  
## <a name="port-sharing-architecture"></a><span data-ttu-id="f3ab3-122">Arquitectura de uso compartido de puertos</span><span class="sxs-lookup"><span data-stu-id="f3ab3-122">Port Sharing Architecture</span></span>  

 <span data-ttu-id="f3ab3-123">La arquitectura de uso compartido de puertos en WCF tiene tres componentes principales:</span><span class="sxs-lookup"><span data-stu-id="f3ab3-123">The Port Sharing architecture in WCF has three main components:</span></span>  
  
- <span data-ttu-id="f3ab3-124">Un proceso de trabajo: cualquier proceso que se comunica sobre net.tcp:// utilizando los puertos compartidos.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-124">A Worker Process: Any process communicating over net.tcp:// using shared ports.</span></span>  
  
- <span data-ttu-id="f3ab3-125">El transporte TCP de WCF: implementa el protocolo net. TCP://.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-125">The WCF TCP transport: Implements the net.tcp:// protocol.</span></span>  
  
- <span data-ttu-id="f3ab3-126">El servicio de uso compartido de puertos Net.TCP: permite que varios procesos de trabajo compartan el mismo puerto TCP.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-126">The Net.TCP Port Sharing Service: Allows many worker processes to share the same TCP port.</span></span>  
  
 <span data-ttu-id="f3ab3-127">El servicio de uso compartido de puertos Net.TCP es un servicio de Windows de modo de usuario que acepta conexiones net.tcp:// en nombre de los procesos de trabajo que se conectan a través de él.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-127">The Net.TCP Port Sharing Service is a user-mode Windows service that accepts net.tcp:// connections on behalf of the worker processes that connect through it.</span></span> <span data-ttu-id="f3ab3-128">Cuando una conexión de socket llega, el servicio de uso compartido de puertos inspecciona la secuencia del mensaje entrante para obtener su dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-128">When a socket connection arrives, the port sharing service inspects the incoming message stream to obtain its destination address.</span></span> <span data-ttu-id="f3ab3-129">Basándose en esta dirección, el servicio de uso compartido de puertos puede enrutar el flujo de datos a la aplicación que finalmente lo procesa.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-129">Based on this address, the port sharing service can route the data stream to the application that ultimately processes it.</span></span>  
  
 <span data-ttu-id="f3ab3-130">Cuando se abre un servicio WCF que emplea el uso compartido de puertos net.tcp://, la infraestructura de transporte TCP de WCF no abre directamente un socket TCP en el proceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-130">When a WCF service that uses net.tcp:// port sharing opens, the WCF TCP transport infrastructure does not directly open a TCP socket in the application process.</span></span> <span data-ttu-id="f3ab3-131">En su lugar, la infraestructura de transporte registra el Identificador uniforme de recursos (URI) de la dirección base del servicio con el servicio de uso compartido de puertos Net.TCP y espera a que el servicio de uso compartido de puertos escuche mensajes en su nombre.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-131">Instead, the transport infrastructure registers the service’s base address Uniform Resource Identifier (URI) with the Net.TCP Port Sharing Service and waits for the port sharing service to listen for messages on its behalf.</span></span>  <span data-ttu-id="f3ab3-132">El servicio de uso compartido de puertos entrega mensajes direccionados al servicio de la aplicación según van llegando.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-132">The port sharing service dispatches messages addressed to the application service as they arrive.</span></span>  
  
## <a name="installing-port-sharing"></a><span data-ttu-id="f3ab3-133">Instalación del uso compartido de puertos</span><span class="sxs-lookup"><span data-stu-id="f3ab3-133">Installing Port Sharing</span></span>  

 <span data-ttu-id="f3ab3-134">El servicio de uso compartido de puertos net. TCP está disponible en todos los sistemas operativos compatibles con WinFX, pero el servicio no está habilitado de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-134">The Net.TCP Port Sharing Service is available on all operating systems that support WinFX, but the service is not enabled by default.</span></span> <span data-ttu-id="f3ab3-135">Como precaución de seguridad, un administrador debe poder habilitar manualmente el servicio de uso compartido de puertos Net.TCP antes de utilizarlo por primera vez.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-135">As a security precaution, an administrator must manually enable the Net.TCP Port Sharing Service prior to first use.</span></span> <span data-ttu-id="f3ab3-136">El servicio de uso compartido de puertos Net.TCP expone opciones de configuración que permiten manipular varias características de los sockets de red que posee el servicio de uso compartido de puertos.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-136">The Net.TCP Port Sharing Service exposes configuration options that allow you to manipulate several characteristics of the network sockets owned by the port sharing service.</span></span> <span data-ttu-id="f3ab3-137">Para obtener más información, consulte [Cómo: habilitar el servicio de uso compartido de puertos net. TCP](how-to-enable-the-net-tcp-port-sharing-service.md).</span><span class="sxs-lookup"><span data-stu-id="f3ab3-137">For more information, see [How to: Enable the Net.TCP Port Sharing Service](how-to-enable-the-net-tcp-port-sharing-service.md).</span></span>  
  
## <a name="using-nettcp-port-sharing-in-an-application"></a><span data-ttu-id="f3ab3-138">Uso del uso compartido de puertos Net.tcp en una aplicación</span><span class="sxs-lookup"><span data-stu-id="f3ab3-138">Using Net.tcp Port Sharing in an Application</span></span>  

 <span data-ttu-id="f3ab3-139">La manera más sencilla de utilizar net. TCP://uso compartido de puertos en la aplicación WCF es exponer un servicio mediante <xref:System.ServiceModel.NetTcpBinding> y, a continuación, habilitar el servicio de uso compartido de puertos net. TCP mediante la <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> propiedad.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-139">The easiest way to use net.tcp:// port sharing in your WCF application is to expose a service using the <xref:System.ServiceModel.NetTcpBinding> and then to enable Net.TCP Port Sharing Service using the <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> property.</span></span>  
  
 <span data-ttu-id="f3ab3-140">Para obtener más información sobre cómo hacerlo, consulte [Cómo: configurar un servicio WCF para usar el uso compartido de puertos](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span><span class="sxs-lookup"><span data-stu-id="f3ab3-140">For more information about how to do this, see [How to: Configure a WCF Service to Use Port Sharing](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span></span>  
  
## <a name="security-implications-of-port-sharing"></a><span data-ttu-id="f3ab3-141">Implicaciones de seguridad del uso compartido de puertos</span><span class="sxs-lookup"><span data-stu-id="f3ab3-141">Security Implications of Port Sharing</span></span>  

 <span data-ttu-id="f3ab3-142">Aunque el servicio de uso compartido de puertos Net.TCP proporciona una capa de procesamiento entre las aplicaciones y la red, las aplicaciones que utilizan el uso compartido de puertos todavía deberían seguir estando protegidas como si estuvieran realizando escuchas directamente en la red.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-142">Although the Net.TCP Port Sharing Service provides a layer of processing between applications and the network, applications that use port sharing should still be secured as if they were directly listening on the network.</span></span> <span data-ttu-id="f3ab3-143">En concreto, las aplicaciones que utilizan el uso compartido de puertos deberían evaluar los privilegios de procesos bajo los que se ejecutan.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-143">Specifically, applications that use port sharing should evaluate the process privileges under which they run.</span></span> <span data-ttu-id="f3ab3-144">Considere ejecutar su aplicación utilizando la cuenta de servicio de red integrada, que se ejecuta con el conjunto mínimo de privilegios de procesos requeridos para la comunicación por red.</span><span class="sxs-lookup"><span data-stu-id="f3ab3-144">Consider running your application using the built-in Network Service account, which runs with the minimal set of process privileges required for network communication.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f3ab3-145">Vea también</span><span class="sxs-lookup"><span data-stu-id="f3ab3-145">See also</span></span>

- [<span data-ttu-id="f3ab3-146">Configuración del servicio de uso compartido de puertos Net.TCP</span><span class="sxs-lookup"><span data-stu-id="f3ab3-146">Configuring the Net.TCP Port Sharing Service</span></span>](configuring-the-net-tcp-port-sharing-service.md)
- [<span data-ttu-id="f3ab3-147">Hospedar aplicaciones de WPF</span><span class="sxs-lookup"><span data-stu-id="f3ab3-147">Hosting</span></span>](hosting.md)
- [<span data-ttu-id="f3ab3-148">Procedimiento para configurar un servicio WCF para habilitar el uso compartido de puertos</span><span class="sxs-lookup"><span data-stu-id="f3ab3-148">How to: Configure a WCF Service to Use Port Sharing</span></span>](how-to-configure-a-wcf-service-to-use-port-sharing.md)
- [<span data-ttu-id="f3ab3-149">Procedimiento para habilitar el servicio de uso compartido de puertos Net.TCP</span><span class="sxs-lookup"><span data-stu-id="f3ab3-149">How to: Enable the Net.TCP Port Sharing Service</span></span>](how-to-enable-the-net-tcp-port-sharing-service.md)
