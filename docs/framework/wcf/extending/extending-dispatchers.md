---
title: Extensión de distribuidores
ms.date: 03/30/2017
helpviewer_keywords:
- dispatcher extensions [WCF]
ms.assetid: d0ad15ac-fa12-4f27-80e8-7ac2271e5985
ms.openlocfilehash: fa9d5c40c2ae813493b3643048fa7eaba00c431d
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96273235"
---
# <a name="extending-dispatchers"></a><span data-ttu-id="02bc1-102">Extensión de distribuidores</span><span class="sxs-lookup"><span data-stu-id="02bc1-102">Extending Dispatchers</span></span>

<span data-ttu-id="02bc1-103">Los distribuidores son los responsables de extraer los mensajes entrantes de los canales subyacentes, de modo que los traducen en código de aplicación en las invocaciones de método y devuelven los resultados al autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="02bc1-103">Dispatchers are responsible for pulling incoming messages out of the underlying channels, translating them into method invocations in application code, and sending the results back to the caller.</span></span> <span data-ttu-id="02bc1-104">Las extensiones de distribuidores le permiten modificar este procesamiento.</span><span class="sxs-lookup"><span data-stu-id="02bc1-104">Dispatcher extensions allow you to modify this processing.</span></span>  <span data-ttu-id="02bc1-105">Puede implementar inspectores de parámetro o de mensaje que inspeccionen o modifiquen el contenido de los mensajes o los parámetros.</span><span class="sxs-lookup"><span data-stu-id="02bc1-105">You can implement message or parameter inspectors that inspect or modify the contents of messages or parameters.</span></span>  <span data-ttu-id="02bc1-106">Puede cambiar la manera en la que se enrutan los mensajes a las operaciones o proporcionar otras funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="02bc1-106">You can change the way messages are routed to operations or provide some other functionality.</span></span>

<span data-ttu-id="02bc1-107">En este tema se describe cómo utilizar <xref:System.ServiceModel.Dispatcher.DispatchRuntime> las <xref:System.ServiceModel.Dispatcher.DispatchOperation> clases y en una aplicación de servicio de Windows Communication Foundation (WCF) para modificar el comportamiento de ejecución predeterminado de un distribuidor o para interceptar o modificar mensajes, parámetros o valores devueltos antes o después de enviarlos o recuperarlos de la capa del canal.</span><span class="sxs-lookup"><span data-stu-id="02bc1-107">This topic describes how to use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and <xref:System.ServiceModel.Dispatcher.DispatchOperation> classes in a Windows Communication Foundation (WCF) service application to modify the default execution behavior of a dispatcher or to intercept or modify messages, parameters, or return values prior to or subsequent to sending or retrieving them from the channel layer.</span></span> <span data-ttu-id="02bc1-108">Para obtener más información sobre el procesamiento de mensajes en tiempo de ejecución de cliente equivalente, consulte [Extending](extending-clients.md)clients.</span><span class="sxs-lookup"><span data-stu-id="02bc1-108">For more information about the equivalent client runtime message processing, see [Extending Clients](extending-clients.md).</span></span> <span data-ttu-id="02bc1-109">Para comprender el rol que los <xref:System.ServiceModel.IExtensibleObject%601> tipos desempeñan en el acceso al estado compartido entre varios objetos de personalización en tiempo de ejecución, vea [objetos extensibles](extensible-objects.md).</span><span class="sxs-lookup"><span data-stu-id="02bc1-109">To understand the role that <xref:System.ServiceModel.IExtensibleObject%601> types play in accessing shared state between various runtime customization objects, see [Extensible Objects](extensible-objects.md).</span></span>

## <a name="dispatchers"></a><span data-ttu-id="02bc1-110">Distribuidores</span><span class="sxs-lookup"><span data-stu-id="02bc1-110">Dispatchers</span></span>

<span data-ttu-id="02bc1-111">El nivel del modelo de servicios realiza la conversión entre el modelo de programación del programador y el intercambio de mensajes subyacentes, comúnmente denominado el nivel de canal.</span><span class="sxs-lookup"><span data-stu-id="02bc1-111">The service model layer performs the conversion between the developer’s programming model and the underlying message exchange, commonly called the channel layer.</span></span> <span data-ttu-id="02bc1-112">En WCF, los distribuidores de canal y punto de conexión ( <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> y <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> , respectivamente) son los componentes de servicio responsables de aceptar nuevos canales, recibir mensajes, operaciones de envío e invocación de operaciones y procesamiento de respuestas.</span><span class="sxs-lookup"><span data-stu-id="02bc1-112">In WCF the channel and endpoint dispatchers (<xref:System.ServiceModel.Dispatcher.ChannelDispatcher> and <xref:System.ServiceModel.Dispatcher.EndpointDispatcher>, respectively) are the service components responsible for accepting new channels, receiving messages, operation dispatch and invocation, and response processing.</span></span> <span data-ttu-id="02bc1-113">Los objetos de distribuidor son objetos de receptor, pero las implementaciones de contratos de devolución de llamadas en servicios dúplex también exponen sus objetos de distribuidor para la inspección, modificación o extensión.</span><span class="sxs-lookup"><span data-stu-id="02bc1-113">Dispatcher objects are receiver objects, but callback contract implementations in duplex services also expose their dispatcher objects for inspection, modification, or extension.</span></span>

<span data-ttu-id="02bc1-114">El distribuidor de canales (y <xref:System.ServiceModel.Channels.IChannelListener> complementario) extrae los mensajes del canal del subordinado y pasa los mensajes a sus distribuidores de extremos respectivos.</span><span class="sxs-lookup"><span data-stu-id="02bc1-114">The channel dispatcher (and companion <xref:System.ServiceModel.Channels.IChannelListener>) pulls messages out of the underling channel and passes the messages to their respective endpoint dispatchers.</span></span> <span data-ttu-id="02bc1-115">Cada distribuidor de extremos tiene un <xref:System.ServiceModel.Dispatcher.DispatchRuntime> que enruta los mensajes a la <xref:System.ServiceModel.Dispatcher.DispatchOperation> adecuada, que es responsable de llamar al método que implementa la operación.</span><span class="sxs-lookup"><span data-stu-id="02bc1-115">Each endpoint dispatcher has a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> that routes messages to the appropriate <xref:System.ServiceModel.Dispatcher.DispatchOperation>, which is responsible for calling the method that implements the operation.</span></span> <span data-ttu-id="02bc1-116">Durante el proceso, se invocan varias clases de extensiones opcionales y obligatorias.</span><span class="sxs-lookup"><span data-stu-id="02bc1-116">Various optional and required extension classes are invoked along the way.</span></span> <span data-ttu-id="02bc1-117">En este tema se explica cómo encajan estas piezas, y cómo podría modificar las propiedades e introducir su propio código para extender la funcionalidad básica.</span><span class="sxs-lookup"><span data-stu-id="02bc1-117">This topic explains how these pieces fit together, and how you might modify properties and plug your own code in to extend the base functionality.</span></span>

<span data-ttu-id="02bc1-118">Las propiedades del distribuidor y los objetos de personalización modificados se insertan utilizando objetos de comportamiento de operación, servicio, punto de conexión, o contrato.</span><span class="sxs-lookup"><span data-stu-id="02bc1-118">Dispatcher properties and modified customization objects are inserted by using service, endpoint, contract, or operation behavior objects.</span></span> <span data-ttu-id="02bc1-119">En este tema no se describe cómo utilizar los comportamientos.</span><span class="sxs-lookup"><span data-stu-id="02bc1-119">This topic does not describe how to use behaviors.</span></span> <span data-ttu-id="02bc1-120">Para obtener más información sobre los tipos que se usan para insertar modificaciones del distribuidor, vea [configurar y extender el Runtime con comportamientos](configuring-and-extending-the-runtime-with-behaviors.md).</span><span class="sxs-lookup"><span data-stu-id="02bc1-120">For more information about the types used to insert dispatcher modifications, see [Configuring and Extending the Runtime with Behaviors](configuring-and-extending-the-runtime-with-behaviors.md).</span></span>

<span data-ttu-id="02bc1-121">El siguiente gráfico proporciona una vista de alto nivel de los elementos arquitectónicos de un servicio.</span><span class="sxs-lookup"><span data-stu-id="02bc1-121">The following graphic provides a high-level view of the architectural items in a service.</span></span>

<span data-ttu-id="02bc1-122">![La arquitectura para este tiempo de ejecución de envío.](./media/wcfc-dispatchruntimearchc.gif "wcfc_DispatchRuntimeArchc")</span><span class="sxs-lookup"><span data-stu-id="02bc1-122">![The dispatch runtime architecture](./media/wcfc-dispatchruntimearchc.gif "wcfc_DispatchRuntimeArchc")</span></span>

### <a name="channel-dispatchers"></a><span data-ttu-id="02bc1-123">Distribuidores de canal</span><span class="sxs-lookup"><span data-stu-id="02bc1-123">Channel Dispatchers</span></span>

<span data-ttu-id="02bc1-124">Se crea un objeto <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> para asociar un <xref:System.ServiceModel.Channels.IChannelListener> de un URI determinado (denominado URI de escucha) a una instancia de un servicio.</span><span class="sxs-lookup"><span data-stu-id="02bc1-124">A <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> object is created to associate an <xref:System.ServiceModel.Channels.IChannelListener> at a particular URI (called a listen URI) with an instance of a service.</span></span> <span data-ttu-id="02bc1-125">Cada objeto <xref:System.ServiceModel.ServiceHost> puede tener muchos objetos <xref:System.ServiceModel.Dispatcher.ChannelDispatcher>, cada uno asociado a un solo agente de escucha y un URI de escucha.</span><span class="sxs-lookup"><span data-stu-id="02bc1-125">Each <xref:System.ServiceModel.ServiceHost> object can have many <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> objects, each associated with only one listener and listen URI.</span></span> <span data-ttu-id="02bc1-126">Cuando llega un mensaje, el objeto <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> consulta a cada uno de los objetos <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> asociados para saber si el extremo puede aceptar el mensaje, y pasa el mensaje a uno que pueda.</span><span class="sxs-lookup"><span data-stu-id="02bc1-126">When a message arrives, the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> queries each of the associated <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objects whether the endpoint can accept the message, and passes the message to the one that can.</span></span>

<span data-ttu-id="02bc1-127">Todas las propiedades que controlan la duración y el comportamiento de una sesión de canal se pueden inspeccionar o modificar en el objeto <xref:System.ServiceModel.Dispatcher.ChannelDispatcher>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-127">All properties that control the lifetime and behavior of a channel session are available for inspection or modification on the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> object.</span></span> <span data-ttu-id="02bc1-128">Entre ellos se incluyen los inicializadores de canales personalizados, el agente de escuchas de canal, el host, el <xref:System.ServiceModel.InstanceContext>asociado, etc.</span><span class="sxs-lookup"><span data-stu-id="02bc1-128">These include custom channel initializers, the channel listener, the host, the associated <xref:System.ServiceModel.InstanceContext>, and so on.</span></span>

### <a name="endpoint-dispatchers"></a><span data-ttu-id="02bc1-129">Distribuidores de puntos de conexión</span><span class="sxs-lookup"><span data-stu-id="02bc1-129">Endpoint Dispatchers</span></span>

<span data-ttu-id="02bc1-130">El objeto <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> es responsable de procesar los mensajes de un objeto <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> cuando la dirección de destino de un mensaje coincide con la propiedad <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.AddressFilter%2A> y la acción del mensaje coincide con la propiedad <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.ContractFilter%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-130">The <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> object is responsible for processing messages from a <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> when the destination address of a message matches the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.AddressFilter%2A> and the message action matches the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.ContractFilter%2A> property.</span></span> <span data-ttu-id="02bc1-131">Si dos objetos <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> pueden aceptar un mensaje, el valor de la propiedad <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.FilterPriority%2A> determina el punto de conexión de mayor prioridad.</span><span class="sxs-lookup"><span data-stu-id="02bc1-131">If two <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objects can accept a message, the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.FilterPriority%2A> property value determines the higher priority endpoint.</span></span>

<span data-ttu-id="02bc1-132">Utilice el <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> para adquirir los dos puntos de extensión de modelo de servicio principales, las clases <xref:System.ServiceModel.Dispatcher.DispatchRuntime> y <xref:System.ServiceModel.Dispatcher.DispatchOperation>, que puede utilizar para personalizar el procesamiento del distribuidor.</span><span class="sxs-lookup"><span data-stu-id="02bc1-132">Use the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> to acquire the two main service model extension points – the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and <xref:System.ServiceModel.Dispatcher.DispatchOperation> classes – that you can use to customize the processing of the dispatcher.</span></span> <span data-ttu-id="02bc1-133">La clase <xref:System.ServiceModel.Dispatcher.DispatchRuntime> permite a los usuarios interceptar y extender el distribuidor en el ámbito del contrato (es decir, para todos los mensajes de un contrato).</span><span class="sxs-lookup"><span data-stu-id="02bc1-133">The <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class allows users to intercept and extend the dispatcher at the contract scope (that is, for all messages in a contract).</span></span> <span data-ttu-id="02bc1-134">La clase <xref:System.ServiceModel.Dispatcher.DispatchOperation> permite a los usuarios interceptar y extender el distribuidor en un ámbito de operación (es decir, para todos los mensajes de una operación).</span><span class="sxs-lookup"><span data-stu-id="02bc1-134">The <xref:System.ServiceModel.Dispatcher.DispatchOperation> class allows users to intercept and extend the dispatcher at an operation scope (that is, for all messages in an operation).</span></span>

## <a name="scenarios"></a><span data-ttu-id="02bc1-135">Escenarios</span><span class="sxs-lookup"><span data-stu-id="02bc1-135">Scenarios</span></span>

<span data-ttu-id="02bc1-136">Hay varias razones para extender el distribuidor:</span><span class="sxs-lookup"><span data-stu-id="02bc1-136">There a number of reasons to extend the dispatcher:</span></span>

- <span data-ttu-id="02bc1-137">Validación personalizada del mensaje.</span><span class="sxs-lookup"><span data-stu-id="02bc1-137">Custom Message Validation.</span></span> <span data-ttu-id="02bc1-138">Los usuarios pueden exigir que un mensaje sea válido para un determinado esquema.</span><span class="sxs-lookup"><span data-stu-id="02bc1-138">Users can enforce that a message is valid for a certain schema.</span></span> <span data-ttu-id="02bc1-139">Esto se puede hacer implementando las interfaces del interceptor de mensajes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-139">This can be done by implementing the message interceptor interfaces.</span></span> <span data-ttu-id="02bc1-140">Para ver un ejemplo, consulte [inspectores de mensajes](../samples/message-inspectors.md).</span><span class="sxs-lookup"><span data-stu-id="02bc1-140">For an example, see [Message Inspectors](../samples/message-inspectors.md).</span></span>

- <span data-ttu-id="02bc1-141">Registro personalizado de mensajes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-141">Custom Message Logging.</span></span> <span data-ttu-id="02bc1-142">Los usuarios pueden inspeccionar y registrar un conjunto de mensajes de la aplicación que fluyen a través de un punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="02bc1-142">Users can inspect and log some set of application messages that flow through an endpoint.</span></span> <span data-ttu-id="02bc1-143">Esto también se puede lograr con las interfaces del interceptor de mensajes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-143">This can also be accomplished with the message interceptor interfaces.</span></span>

- <span data-ttu-id="02bc1-144">Transformaciones personalizadas del mensaje.</span><span class="sxs-lookup"><span data-stu-id="02bc1-144">Custom Message Transformations.</span></span> <span data-ttu-id="02bc1-145">Los usuarios pueden aplicar ciertas transformaciones al mensaje en el runtime (por ejemplo, para el control de versiones).</span><span class="sxs-lookup"><span data-stu-id="02bc1-145">Users can apply certain transformations to the message in the runtime (for example, for versioning).</span></span> <span data-ttu-id="02bc1-146">Esto también se puede lograr, de nuevo, con las interfaces del interceptor de mensajes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-146">This can be accomplished, again, with the message interceptor interfaces.</span></span>

- <span data-ttu-id="02bc1-147">Modelo de datos personalizado.</span><span class="sxs-lookup"><span data-stu-id="02bc1-147">Custom Data Model.</span></span> <span data-ttu-id="02bc1-148">Los usuarios pueden tener un modelo de serialización de datos distinto de los que se admiten de forma predeterminada en WCF (es decir, <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType> los mensajes, y sin formato).</span><span class="sxs-lookup"><span data-stu-id="02bc1-148">Users can have a data serialization model other than those supported by default in WCF (namely, <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>, <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>, and raw messages).</span></span> <span data-ttu-id="02bc1-149">Esto se puede hacer implementando las interfaces del formateador de mensajes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-149">This can be done by implement the message formatter interfaces.</span></span> <span data-ttu-id="02bc1-150">Para obtener un ejemplo, vea [formateador de operaciones y selector de operaciones](../samples/operation-formatter-and-operation-selector.md).</span><span class="sxs-lookup"><span data-stu-id="02bc1-150">For an example, see [Operation Formatter and Operation Selector](../samples/operation-formatter-and-operation-selector.md).</span></span>

- <span data-ttu-id="02bc1-151">Validación personalizada de parámetros.</span><span class="sxs-lookup"><span data-stu-id="02bc1-151">Custom Parameter Validation.</span></span> <span data-ttu-id="02bc1-152">Los usuarios pueden exigir que los parámetros con tipo sean válidos (por oposición a XML).</span><span class="sxs-lookup"><span data-stu-id="02bc1-152">Users can enforce that typed parameters are valid (as opposed to XML).</span></span> <span data-ttu-id="02bc1-153">Esto puede hacerse mediante las interfaces del inspector de parámetros.</span><span class="sxs-lookup"><span data-stu-id="02bc1-153">This can be done using the parameter inspector interfaces.</span></span>

- <span data-ttu-id="02bc1-154">Distribución de operaciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="02bc1-154">Custom Operation Dispatching.</span></span> <span data-ttu-id="02bc1-155">Los usuarios pueden implementar la distribución en algo que no sea una acción; por ejemplo, en el elemento de cuerpo o en una propiedad de un mensaje personalizado.</span><span class="sxs-lookup"><span data-stu-id="02bc1-155">Users can implement dispatching on something other than action – for example, on the body element, or on a custom message property.</span></span> <span data-ttu-id="02bc1-156">Esto se puede hacer mediante la interfaz <xref:System.ServiceModel.Dispatcher.IDispatchOperationSelector>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-156">This can be done using the <xref:System.ServiceModel.Dispatcher.IDispatchOperationSelector> interface.</span></span> <span data-ttu-id="02bc1-157">Para obtener un ejemplo, vea [formateador de operaciones y selector de operaciones](../samples/operation-formatter-and-operation-selector.md).</span><span class="sxs-lookup"><span data-stu-id="02bc1-157">For an example, see [Operation Formatter and Operation Selector](../samples/operation-formatter-and-operation-selector.md).</span></span>

- <span data-ttu-id="02bc1-158">Agrupación de objetos.</span><span class="sxs-lookup"><span data-stu-id="02bc1-158">Object Pooling.</span></span> <span data-ttu-id="02bc1-159">Los usuarios pueden agrupar instancias en lugar de asignar una nueva instancia a cada llamada.</span><span class="sxs-lookup"><span data-stu-id="02bc1-159">Users can pool instances rather than allocating a new one for every call.</span></span> <span data-ttu-id="02bc1-160">Esto se puede implementar mediante las interfaces proveedoras de instancias.</span><span class="sxs-lookup"><span data-stu-id="02bc1-160">This can be implemented using the instance provider interfaces.</span></span> <span data-ttu-id="02bc1-161">Para obtener un ejemplo, consulte [agrupación](../samples/pooling.md).</span><span class="sxs-lookup"><span data-stu-id="02bc1-161">For an example, see [Pooling](../samples/pooling.md).</span></span>

- <span data-ttu-id="02bc1-162">Arrendamiento de instancias.</span><span class="sxs-lookup"><span data-stu-id="02bc1-162">Instance Leasing.</span></span> <span data-ttu-id="02bc1-163">Los usuarios pueden implementar un patrón de arrendamiento para la duración de instancias, similar al de .NET Framework Remoting.</span><span class="sxs-lookup"><span data-stu-id="02bc1-163">Users can implement a leasing pattern for instance lifetime, similar to that of .NET Framework Remoting.</span></span> <span data-ttu-id="02bc1-164">Esto se puede hacer mediante las interfaces de duración de contexto de instancias.</span><span class="sxs-lookup"><span data-stu-id="02bc1-164">This can be done using the instance context lifetime interfaces.</span></span>

- <span data-ttu-id="02bc1-165">Control de errores personalizado.</span><span class="sxs-lookup"><span data-stu-id="02bc1-165">Custom Error Handling.</span></span> <span data-ttu-id="02bc1-166">Los usuarios pueden controlar cómo se procesan los errores locales y cómo se devuelven los errores a los clientes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-166">Users can control how both local errors are processed and how faults are communicated back to clients.</span></span> <span data-ttu-id="02bc1-167">Esto se puede implementar utilizando las interfaces <xref:System.ServiceModel.Dispatcher.IErrorHandler>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-167">This can be implemented using the <xref:System.ServiceModel.Dispatcher.IErrorHandler> interfaces.</span></span>

- <span data-ttu-id="02bc1-168">Comportamientos de autorización personalizados.</span><span class="sxs-lookup"><span data-stu-id="02bc1-168">Custom Authorization Behaviors.</span></span> <span data-ttu-id="02bc1-169">Los usuarios pueden implementar un control de acceso personalizado extendiendo las partes en tiempo de ejecución de contratos u operaciones y agregando comprobaciones de seguridad basadas en los tokens presentes en el mensaje.</span><span class="sxs-lookup"><span data-stu-id="02bc1-169">Users can implement custom access control by extending the Contract or Operation run-time pieces and adding security checks based upon the tokens present in the message.</span></span> <span data-ttu-id="02bc1-170">Esto se puede lograr utilizando las interfaces del interceptor de mensajes o del interceptor de parámetros.</span><span class="sxs-lookup"><span data-stu-id="02bc1-170">This can be accomplished using either the message interceptor or parameter interceptor interfaces.</span></span> <span data-ttu-id="02bc1-171">Para obtener ejemplos, vea [extensibilidad de seguridad](../samples/security-extensibility.md).</span><span class="sxs-lookup"><span data-stu-id="02bc1-171">For examples, see [Security Extensibility](../samples/security-extensibility.md).</span></span>

  > [!CAUTION]
  > <span data-ttu-id="02bc1-172">Dado que la modificación de las propiedades de seguridad tiene la posibilidad de poner en peligro la seguridad de las aplicaciones WCF, se recomienda encarecidamente realizar modificaciones relacionadas con la seguridad con cuidado y realizar pruebas exhaustivas antes de la implementación.</span><span class="sxs-lookup"><span data-stu-id="02bc1-172">Because altering security properties has the potential to compromise the security of WCF applications, it is strongly recommended that you undertake security-related modifications with care and test thoroughly prior to deployment.</span></span>

- <span data-ttu-id="02bc1-173">Validadores personalizados de WCF en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="02bc1-173">Custom WCF Runtime Validators.</span></span> <span data-ttu-id="02bc1-174">Puede instalar validadores personalizados que examinen servicios, contratos y enlaces para aplicar directivas de nivel empresarial con respecto a las aplicaciones WCF.</span><span class="sxs-lookup"><span data-stu-id="02bc1-174">You can install custom validators that examine services, contracts, and bindings to enforce enterprise-level policies with respect to WCF applications.</span></span> <span data-ttu-id="02bc1-175">(Por ejemplo, consulte [Cómo: bloquear puntos de conexión en la empresa](how-to-lock-down-endpoints-in-the-enterprise.md)).</span><span class="sxs-lookup"><span data-stu-id="02bc1-175">(For example, see [How to: Lock Down Endpoints in the Enterprise](how-to-lock-down-endpoints-in-the-enterprise.md).)</span></span>

### <a name="using-the-dispatchruntime-class"></a><span data-ttu-id="02bc1-176">Uso de la clase DispatchRuntime</span><span class="sxs-lookup"><span data-stu-id="02bc1-176">Using the DispatchRuntime Class</span></span>

<span data-ttu-id="02bc1-177">Utilice la clase <xref:System.ServiceModel.Dispatcher.DispatchRuntime> para modificar el comportamiento predeterminado de punto de conexión individual o de servicio, o para insertar objetos que implementen modificaciones personalizadas en uno o ambos de los siguientes procesos de servicio (o procesos de cliente en el caso de un cliente dúplex):</span><span class="sxs-lookup"><span data-stu-id="02bc1-177">Use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class either to modify the default behavior of a service or individual endpoint, or to insert objects that implement custom modifications to one or both of the following service processes (or client processes in the case of a duplex client):</span></span>

- <span data-ttu-id="02bc1-178">La transformación de mensajes entrantes en los objetos y la suelta de esos objetos como invocaciones de método en un objeto de servicio.</span><span class="sxs-lookup"><span data-stu-id="02bc1-178">The transformation of incoming messages into objects and releasing those objects as method invocations on a service object.</span></span>

- <span data-ttu-id="02bc1-179">La transformación de objetos recibidos de la respuesta a una invocación de operación de servicio en mensajes salientes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-179">The transformation of objects received from the response to a service operation invocation into outbound messages.</span></span>

<span data-ttu-id="02bc1-180"><xref:System.ServiceModel.Dispatcher.DispatchRuntime> le permite interceptar y extender el canal o el distribuidor del extremo para todos los mensajes de un contrato determinado, incluso cuando no se reconoce un mensaje.</span><span class="sxs-lookup"><span data-stu-id="02bc1-180">The <xref:System.ServiceModel.Dispatcher.DispatchRuntime> enables you to intercept and extend the channel or endpoint dispatcher for all messages across a particular contract, even when a message is not recognized.</span></span> <span data-ttu-id="02bc1-181">Cuando llega un mensaje que no coincide con ningún mensaje declarado en el contrato, se envía a la operación devuelta por la propiedad <xref:System.ServiceModel.Dispatcher.DispatchRuntime.UnhandledDispatchOperation%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-181">When a message arrives that does not match any declared in the contract it is dispatched to the operation returned by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.UnhandledDispatchOperation%2A> property.</span></span> <span data-ttu-id="02bc1-182">Para interceptar o extenderse por todos los mensajes de una operación determinada, vea la clase <xref:System.ServiceModel.Dispatcher.DispatchOperation>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-182">To intercept or extend across all messages for a particular operation, see the <xref:System.ServiceModel.Dispatcher.DispatchOperation> class.</span></span>

<span data-ttu-id="02bc1-183">Hay cuatro áreas principales de extensibilidad del distribuidor expuestas por la clase <xref:System.ServiceModel.Dispatcher.DispatchRuntime>:</span><span class="sxs-lookup"><span data-stu-id="02bc1-183">There are four main areas of dispatcher extensibility exposed by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class:</span></span>

1. <span data-ttu-id="02bc1-184">Los componentes de canal utilizan las propiedades de <xref:System.ServiceModel.Dispatcher.DispatchRuntime> y las del distribuidor del canal asociado devueltas por la propiedad <xref:System.ServiceModel.Dispatcher.DispatchRuntime.ChannelDispatcher%2A> para personalizar cómo el distribuidor del canal acepta y cierra los canales.</span><span class="sxs-lookup"><span data-stu-id="02bc1-184">Channel components use the properties of the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and those of the associated channel dispatcher returned by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.ChannelDispatcher%2A> property to customize how the channel dispatcher accepts and closes channels.</span></span> <span data-ttu-id="02bc1-185">Esta categoría incluye las propiedades <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ChannelInitializers%2A> y <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InputSessionShutdownHandlers%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-185">This category includes the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ChannelInitializers%2A> and <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InputSessionShutdownHandlers%2A> properties.</span></span>

2. <span data-ttu-id="02bc1-186">Los componentes de mensaje se personalizan para cada mensaje procesado.</span><span class="sxs-lookup"><span data-stu-id="02bc1-186">Message components are customized for each message processed.</span></span> <span data-ttu-id="02bc1-187">Esta categoría incluye las propiedades <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.OperationSelector%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> y <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ErrorHandlers%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-187">This category includes the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.OperationSelector%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A>, and the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ErrorHandlers%2A> properties.</span></span>

3. <span data-ttu-id="02bc1-188">Los componentes de instancia personalizan la creación, duración y eliminación de instancias del tipo de servicio.</span><span class="sxs-lookup"><span data-stu-id="02bc1-188">Instance components customize the creation, lifetime, and disposal of instances of the service type.</span></span> <span data-ttu-id="02bc1-189">Para obtener más información acerca de la duración de los objetos de servicio, vea la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-189">For more information about service object lifetimes, see the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property.</span></span> <span data-ttu-id="02bc1-190">Esta categoría incluye las propiedades <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceContextInitializers%2A> y <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-190">This category includes the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceContextInitializers%2A> and the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceProvider%2A> properties.</span></span>

4. <span data-ttu-id="02bc1-191">Los componentes relacionados con seguridad pueden utilizar las propiedades siguientes:</span><span class="sxs-lookup"><span data-stu-id="02bc1-191">Security-related components can use the following properties:</span></span>

    - <span data-ttu-id="02bc1-192"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> indica donde se escriben los eventos de auditoría.</span><span class="sxs-lookup"><span data-stu-id="02bc1-192"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> indicates where audit events are written.</span></span>

    - <span data-ttu-id="02bc1-193"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ImpersonateCallerForAllOperations%2A> controla si el servicio intenta suplantar mediante las credenciales proporcionadas por el mensaje entrante.</span><span class="sxs-lookup"><span data-stu-id="02bc1-193"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ImpersonateCallerForAllOperations%2A> controls whether the service attempts to impersonate using the credentials provided by the incoming message.</span></span>

    - <span data-ttu-id="02bc1-194"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageAuthenticationAuditLevel%2A> controla si los eventos de autenticación de mensajes correctos se escriben en el registro de eventos especificado por <xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-194"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageAuthenticationAuditLevel%2A> controls whether successful message authentication events are written to the event log specified by <xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A>.</span></span>

    - <span data-ttu-id="02bc1-195"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.PrincipalPermissionMode%2A> controla cómo se establece la propiedad <xref:System.Threading.Thread.CurrentPrincipal%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-195"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.PrincipalPermissionMode%2A> controls how the <xref:System.Threading.Thread.CurrentPrincipal%2A> property is set.</span></span>

    - <span data-ttu-id="02bc1-196"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ServiceAuthorizationAuditLevel%2A> especifica cómo se realiza la auditoría de eventos de autorización.</span><span class="sxs-lookup"><span data-stu-id="02bc1-196"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ServiceAuthorizationAuditLevel%2A> specifies how the auditing of authorization events is performed.</span></span>

    - <span data-ttu-id="02bc1-197"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SuppressAuditFailure%2A> especifica si suprimir excepciones no críticas que producen durante el proceso del registro.</span><span class="sxs-lookup"><span data-stu-id="02bc1-197"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SuppressAuditFailure%2A> specifies whether to suppress non-critical exceptions that occur during the logging process.</span></span>

<span data-ttu-id="02bc1-198">Normalmente, un comportamiento de servicio (un objeto que implementa <xref:System.ServiceModel.Dispatcher.DispatchRuntime>), un comportamiento de contrato (un objeto que implementa <xref:System.ServiceModel.Description.IServiceBehavior>) o un comportamiento de extremo (un objeto que implementa <xref:System.ServiceModel.Description.IContractBehavior>) pueden asignar objetos de extensión a una propiedad <xref:System.ServiceModel.Description.IEndpointBehavior> o insertarlos en una colección.</span><span class="sxs-lookup"><span data-stu-id="02bc1-198">Typically, custom extension objects are assigned to a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> property or inserted into a collection by a service behavior (an object that implements <xref:System.ServiceModel.Description.IServiceBehavior>), a contract behavior (an object that implements <xref:System.ServiceModel.Description.IContractBehavior>), or an endpoint behavior (an object that implements <xref:System.ServiceModel.Description.IEndpointBehavior>).</span></span> <span data-ttu-id="02bc1-199">Entonces, el objeto de comportamiento de instalación se agrega a la colección adecuada de comportamientos mediante programación o implementando un objeto <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> personalizado para permitir insertar el comportamiento con un archivo de configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="02bc1-199">Then the installing behavior object is added to the appropriate collection of behaviors either programmatically or by implementing a custom <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> object to enable the behavior to be inserted using an application configuration file.</span></span>

<span data-ttu-id="02bc1-200">Los clientes dúplex (clientes que implementan un contrato de devolución de llamadas especificado por un servicio dúplex) también tienen un objeto <xref:System.ServiceModel.Dispatcher.DispatchRuntime> al que se puede obtener acceso usando la propiedad <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-200">Duplex clients (clients that implement a callback contract specified by a duplex service) also have a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> object that can be accessed using the <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> property.</span></span>

### <a name="using-the-dispatchoperation-class"></a><span data-ttu-id="02bc1-201">Uso de la clase DispatchOperation</span><span class="sxs-lookup"><span data-stu-id="02bc1-201">Using the DispatchOperation Class</span></span>

<span data-ttu-id="02bc1-202">La clase <xref:System.ServiceModel.Dispatcher.DispatchOperation> es la ubicación para las modificaciones en tiempo de ejecución y el punto de inserción para las extensiones personalizadas cuyo ámbito es solo una operación de servicio.</span><span class="sxs-lookup"><span data-stu-id="02bc1-202">The <xref:System.ServiceModel.Dispatcher.DispatchOperation> class is the location for run-time modifications and the insertion point for custom extensions that are scoped to only one service operation.</span></span> <span data-ttu-id="02bc1-203">(Para modificar el comportamiento del tiempo de ejecución del servicio para todos los mensajes de un contrato, use la clase <xref:System.ServiceModel.Dispatcher.DispatchRuntime>.)</span><span class="sxs-lookup"><span data-stu-id="02bc1-203">(To modify service run-time behavior for all messages in a contract, use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class.)</span></span>

<span data-ttu-id="02bc1-204">Instale las modificaciones de <xref:System.ServiceModel.Dispatcher.DispatchOperation> utilizando un objeto de comportamiento del servicio personalizado.</span><span class="sxs-lookup"><span data-stu-id="02bc1-204">Install <xref:System.ServiceModel.Dispatcher.DispatchOperation> modifications using a custom service behavior object.</span></span>

<span data-ttu-id="02bc1-205">Use la propiedad <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> para buscar el objeto <xref:System.ServiceModel.Dispatcher.DispatchOperation> que representa una operación de servicio determinada.</span><span class="sxs-lookup"><span data-stu-id="02bc1-205">Use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> property to locate the <xref:System.ServiceModel.Dispatcher.DispatchOperation> object that represents a particular service operation.</span></span>

<span data-ttu-id="02bc1-206">Las siguientes propiedades controlan la ejecución en tiempo de ejecución en el nivel de operación:</span><span class="sxs-lookup"><span data-stu-id="02bc1-206">The following properties control runtime execution at the operation level:</span></span>

- <span data-ttu-id="02bc1-207">Las propiedades <xref:System.ServiceModel.Dispatcher.DispatchOperation.Action%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReplyAction%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.FaultContractInfos%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsOneWay%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsTerminating%2A> y <xref:System.ServiceModel.Dispatcher.DispatchOperation.Name%2A> obtienen los valores correspondientes para la operación.</span><span class="sxs-lookup"><span data-stu-id="02bc1-207">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Action%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReplyAction%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.FaultContractInfos%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsOneWay%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsTerminating%2A>, and <xref:System.ServiceModel.Dispatcher.DispatchOperation.Name%2A> properties obtain the respective values for the operation.</span></span>

- <span data-ttu-id="02bc1-208">Las propiedades <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionAutoComplete%2A> y <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionRequired%2A> especifican el comportamiento de transacciones.</span><span class="sxs-lookup"><span data-stu-id="02bc1-208">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionAutoComplete%2A> and <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionRequired%2A> specify transaction behavior.</span></span>

- <span data-ttu-id="02bc1-209">Las propiedades <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceBeforeCall%2A> y <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceAfterCall%2A> controlan la duración del objeto de servicio definido por el usuario relativo a <xref:System.ServiceModel.InstanceContext>.</span><span class="sxs-lookup"><span data-stu-id="02bc1-209">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceBeforeCall%2A> and <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceAfterCall%2A> properties control the lifetime of the user-defined service object relative to the <xref:System.ServiceModel.InstanceContext>.</span></span>

- <span data-ttu-id="02bc1-210">Las propiedades <xref:System.ServiceModel.Dispatcher.DispatchOperation.DeserializeRequest%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.SerializeReply%2A>y <xref:System.ServiceModel.Dispatcher.DispatchOperation.Formatter%2A> habilitan el control explícito sobre la conversión de los mensajes en los objetos, y de los objetos en mensajes.</span><span class="sxs-lookup"><span data-stu-id="02bc1-210">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.DeserializeRequest%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.SerializeReply%2A>, and the <xref:System.ServiceModel.Dispatcher.DispatchOperation.Formatter%2A> properties enable explicit control over the conversion from messages to objects and objects to messages.</span></span>

- <span data-ttu-id="02bc1-211">La propiedad <xref:System.ServiceModel.Dispatcher.DispatchOperation.Impersonation%2A> especifica el nivel de suplantación de la operación.</span><span class="sxs-lookup"><span data-stu-id="02bc1-211">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Impersonation%2A> property specifies the operation impersonation level.</span></span>

- <span data-ttu-id="02bc1-212">La propiedad <xref:System.ServiceModel.Dispatcher.DispatchOperation.CallContextInitializers%2A> inserta extensiones de contexto de llamada personalizadas para la operación.</span><span class="sxs-lookup"><span data-stu-id="02bc1-212">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.CallContextInitializers%2A> property inserts custom call context extensions for the operation.</span></span>

- <span data-ttu-id="02bc1-213">La propiedad <xref:System.ServiceModel.Dispatcher.DispatchOperation.AutoDisposeParameters%2A> controla cuando se destruyen los objetos de parámetro.</span><span class="sxs-lookup"><span data-stu-id="02bc1-213">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.AutoDisposeParameters%2A> property controls when parameter objects are destroyed.</span></span>

- <span data-ttu-id="02bc1-214">La propiedad <xref:System.ServiceModel.Dispatcher.DispatchOperation.Invoker%2A> se usa para insertar un objeto autor de llamada personalizado.</span><span class="sxs-lookup"><span data-stu-id="02bc1-214">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Invoker%2A> property to insert a custom invoker object.</span></span>

- <span data-ttu-id="02bc1-215">La propiedad <xref:System.ServiceModel.Dispatcher.DispatchOperation.ParameterInspectors%2A> permite insertar un inspector de parámetros personalizado que se puede utilizar para inspeccionar o modificar parámetros y valores devueltos.</span><span class="sxs-lookup"><span data-stu-id="02bc1-215">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.ParameterInspectors%2A> property enables you to insert a custom parameter inspector that you can use to inspect or modify parameters and return values.</span></span>

## <a name="see-also"></a><span data-ttu-id="02bc1-216">Vea también</span><span class="sxs-lookup"><span data-stu-id="02bc1-216">See also</span></span>

- <xref:System.ServiceModel.Dispatcher.DispatchRuntime>
- <xref:System.ServiceModel.Dispatcher.DispatchOperation>
- [<span data-ttu-id="02bc1-217">Procedimiento para inspeccionar y modificar mensajes en el servicio</span><span class="sxs-lookup"><span data-stu-id="02bc1-217">How to: Inspect and Modify Messages on the Service</span></span>](how-to-inspect-and-modify-messages-on-the-service.md)
- [<span data-ttu-id="02bc1-218">Procedimiento para inspeccionar o modificar parámetros</span><span class="sxs-lookup"><span data-stu-id="02bc1-218">How to: Inspect or Modify Parameters</span></span>](how-to-inspect-or-modify-parameters.md)
- [<span data-ttu-id="02bc1-219">Procedimiento para bloquear puntos de conexión en la empresa</span><span class="sxs-lookup"><span data-stu-id="02bc1-219">How to: Lock Down Endpoints in the Enterprise</span></span>](how-to-lock-down-endpoints-in-the-enterprise.md)
