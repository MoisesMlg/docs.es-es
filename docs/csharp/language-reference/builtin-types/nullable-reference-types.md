---
title: 'Tipos de referencia que aceptan valores NULL: referencia de C#'
description: Información sobre los tipos de referencia que aceptan valores NULL de C# y su uso
ms.date: 04/06/2020
ms.openlocfilehash: d961af9ba3b4776e6b4ec3eeea5392fb0d0394ce
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/18/2020
ms.locfileid: "94822430"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="b5933-103">Tipos de referencia que aceptan valores NULL (referencia de C#)</span><span class="sxs-lookup"><span data-stu-id="b5933-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="b5933-104">En este artículo se tratan los tipos de referencia que aceptan valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-104">This article covers nullable reference types.</span></span> <span data-ttu-id="b5933-105">También puede declarar [tipos de valor que aceptan valores NULL](nullable-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="b5933-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="b5933-106">Los tipos de referencia que aceptan valores NULL están disponibles a partir de C# 8.0, en un código que ha participado en un *contexto compatible con valores NULL*.</span><span class="sxs-lookup"><span data-stu-id="b5933-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="b5933-107">Los tipos de referencia que aceptan valores NULL, las advertencias de análisis estático NULL y el [operador null-forgiving](../operators/null-forgiving.md) son características de lenguaje opcionales.</span><span class="sxs-lookup"><span data-stu-id="b5933-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="b5933-108">Todas están desactivadas de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="b5933-108">All are turned off by default.</span></span> <span data-ttu-id="b5933-109">Un *contexto que admite valores NULL* se controla en el nivel de proyecto mediante la configuración de compilación o en el código que usa pragmas.</span><span class="sxs-lookup"><span data-stu-id="b5933-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="b5933-110">En un contexto compatible con valores NULL:</span><span class="sxs-lookup"><span data-stu-id="b5933-110">In a nullable aware context:</span></span>

- <span data-ttu-id="b5933-111">Una variable de un tipo de referencia `T` se debe inicializar con un valor distinto de NULL y nunca puede tener asignado un valor que sea `null`.</span><span class="sxs-lookup"><span data-stu-id="b5933-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="b5933-112">Una variable de un tipo de referencia `T?` se puede inicializar con `null` o asignarle `null`, pero debe comprobarse con `null` antes de desreferenciarla.</span><span class="sxs-lookup"><span data-stu-id="b5933-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="b5933-113">Una variable `m` de tipo `T?` se considera que no es NULL cuando se aplica el operador null-forgiving, como en `m!`.</span><span class="sxs-lookup"><span data-stu-id="b5933-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="b5933-114">Las distinciones entre un tipo de referencia que no acepta valores NULL `T` y un tipo de referencia que acepta valores NULL `T?` se aplican mediante la interpretación del compilador de las reglas anteriores.</span><span class="sxs-lookup"><span data-stu-id="b5933-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="b5933-115">Una variable de tipo `T` y una variable de tipo `T?` se representan mediante el mismo tipo .NET.</span><span class="sxs-lookup"><span data-stu-id="b5933-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="b5933-116">En el ejemplo siguiente se declara una cadena que no acepta valores NULL y una cadena que acepta valores NULL y luego se usa el operador null-forgiving para asignar un valor a una cadena que no acepta valores NULL:</span><span class="sxs-lookup"><span data-stu-id="b5933-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="b5933-117">Las variables `notNull` y `nullable` se ambas representan con el tipo <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="b5933-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="b5933-118">Dado que los tipos que no aceptan valores NULL y que aceptan valores NULL se almacenan como el mismo tipo, hay varias ubicaciones en las que no se permite el uso de un tipo de referencia que acepte valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="b5933-119">En general, un tipo de referencia que acepta valores NULL no se puede usar como clase base o interfaz implementada.</span><span class="sxs-lookup"><span data-stu-id="b5933-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="b5933-120">No se puede usar un tipo de referencia que acepte valores NULL en ninguna expresión de creación de objetos o de expresión de prueba de tipos.</span><span class="sxs-lookup"><span data-stu-id="b5933-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="b5933-121">Un tipo de referencia que acepta valores NULL no puede ser el tipo de una expresión de acceso a miembros.</span><span class="sxs-lookup"><span data-stu-id="b5933-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="b5933-122">En los siguientes ejemplos se muestran estas construcciones:</span><span class="sxs-lookup"><span data-stu-id="b5933-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="b5933-123">Referencias que aceptan valores NULL y análisis estático</span><span class="sxs-lookup"><span data-stu-id="b5933-123">Nullable references and static analysis</span></span>

<span data-ttu-id="b5933-124">Los ejemplos de la sección anterior muestran la naturaleza de los tipos de referencia que aceptan valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="b5933-125">Los tipos de referencia que aceptan valores NULL no son nuevos tipos de clase, sino anotaciones en tipos de referencia existentes.</span><span class="sxs-lookup"><span data-stu-id="b5933-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="b5933-126">El compilador utiliza esas anotaciones para ayudarle a encontrar posibles errores de referencia nula en el código.</span><span class="sxs-lookup"><span data-stu-id="b5933-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="b5933-127">No hay ninguna diferencia en tiempo de ejecución entre un tipo de referencia que no acepta valores NULL y un tipo de referencia que acepta valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="b5933-128">El compilador no agrega ninguna comprobación de tiempo de ejecución para los tipos de referencia que no aceptan valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="b5933-129">Las ventajas radican en el análisis en tiempo de compilación.</span><span class="sxs-lookup"><span data-stu-id="b5933-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="b5933-130">El compilador genera advertencias que le ayudan a encontrar y corregir posibles errores nulos en el código.</span><span class="sxs-lookup"><span data-stu-id="b5933-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="b5933-131">Declare su intención y el compilador le advierte cuando el código infringe dicha intención.</span><span class="sxs-lookup"><span data-stu-id="b5933-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="b5933-132">En un contexto habilitado para valores NULL, el compilador realiza un análisis estático de las variables de cualquier tipo de referencia, tanto si admiten valores NULL como si no aceptan valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="b5933-133">El compilador realiza un seguimiento del estado NULL de cada variable de referencia como *no NULL* o *quizás NULL*.</span><span class="sxs-lookup"><span data-stu-id="b5933-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="b5933-134">El estado predeterminado de una referencia que no acepta valores NULL es *no NULL*.</span><span class="sxs-lookup"><span data-stu-id="b5933-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="b5933-135">El estado predeterminado de una referencia que acepta valores NULL es *quizás NULL*.</span><span class="sxs-lookup"><span data-stu-id="b5933-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="b5933-136">Los tipos de referencia que no aceptan valores NULL siempre deben ser seguros para desreferenciar porque su estado NULL es *no NULL*.</span><span class="sxs-lookup"><span data-stu-id="b5933-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="b5933-137">Para aplicar esa regla, el compilador emite advertencias si un tipo de referencia que no acepta valores NULL no se inicializa en un valor no NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="b5933-138">Las variables locales deben asignarse allí donde se declaran.</span><span class="sxs-lookup"><span data-stu-id="b5933-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="b5933-139">Cada constructor debe asignar todos los campos, ya sea en el cuerpo, en un constructor llamado o con un inicializador de campo.</span><span class="sxs-lookup"><span data-stu-id="b5933-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="b5933-140">El compilador emite advertencias si una referencia que no acepta valores NULL se asigna a una referencia cuyo estado es *quizás NULL*.</span><span class="sxs-lookup"><span data-stu-id="b5933-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="b5933-141">Sin embargo, dado que una referencia que no acepta valores NULL es *no NULL*, no se emite ninguna advertencia cuando se desreferencian esas variables.</span><span class="sxs-lookup"><span data-stu-id="b5933-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="b5933-142">Los tipos de referencia que aceptan valores NULL se pueden inicializar o asignar a `null`.</span><span class="sxs-lookup"><span data-stu-id="b5933-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="b5933-143">Por lo tanto, el análisis estático debe determinar que una variable es *no NULL* antes de desreferenciarla.</span><span class="sxs-lookup"><span data-stu-id="b5933-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="b5933-144">Si se determina que una referencia que acepta valores NULL es *quizás NULL*, no se puede asignar a una variable de referencia que no acepte valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="b5933-145">La consulta siguiente muestra ejemplos de estas advertencias:</span><span class="sxs-lookup"><span data-stu-id="b5933-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="b5933-146">En el fragmento de código siguiente se muestra dónde el compilador emite advertencias al utilizar esta clase:</span><span class="sxs-lookup"><span data-stu-id="b5933-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="b5933-147">En los ejemplos anteriores se muestra el análisis estático del compilador para determinar el estado NULL de las variables de referencia.</span><span class="sxs-lookup"><span data-stu-id="b5933-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="b5933-148">El compilador aplica las reglas de lenguaje a las asignaciones y comprobaciones de valores NULL para informar de su análisis.</span><span class="sxs-lookup"><span data-stu-id="b5933-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="b5933-149">El compilador no puede hacer suposiciones sobre la semántica de métodos o propiedades.</span><span class="sxs-lookup"><span data-stu-id="b5933-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="b5933-150">Si llama a métodos que realizan comprobaciones de valores NULL, el compilador no puede saber que estos métodos afectan al estado NULL de una variable.</span><span class="sxs-lookup"><span data-stu-id="b5933-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="b5933-151">Hay una serie de atributos que puede agregar a las API para informar al compilador sobre la semántica de los argumentos y los valores devueltos.</span><span class="sxs-lookup"><span data-stu-id="b5933-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="b5933-152">Estos atributos se han aplicado a muchas API comunes de las bibliotecas de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="b5933-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="b5933-153">Por ejemplo, <xref:System.String.IsNullOrEmpty%2A> se ha actualizado y el compilador interpreta correctamente ese método como una comprobación de valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="b5933-154">Para obtener más información sobre los atributos que se aplican al análisis estático de estado NULL, consulte el artículo sobre [atributos que aceptan valores NULL](../attributes/nullable-analysis.md).</span><span class="sxs-lookup"><span data-stu-id="b5933-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../attributes/nullable-analysis.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="b5933-155">Establecimiento del contexto que acepta valores NULL</span><span class="sxs-lookup"><span data-stu-id="b5933-155">Setting the nullable context</span></span>

<span data-ttu-id="b5933-156">Hay dos formas de controlar el contexto que acepta valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="b5933-157">En el nivel de proyecto, puede agregar la configuración del proyecto `<Nullable>enable</Nullable>`.</span><span class="sxs-lookup"><span data-stu-id="b5933-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="b5933-158">En un archivo C# de código fuente único, puede agregar el pragma `#nullable enable` para habilitar el contexto que acepta valores NULL.</span><span class="sxs-lookup"><span data-stu-id="b5933-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="b5933-159">Consulte el artículo sobre cómo [establecer una estrategia que acepte valores NULL](../../nullable-migration-strategies.md).</span><span class="sxs-lookup"><span data-stu-id="b5933-159">See the article on [setting a nullable strategy](../../nullable-migration-strategies.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="b5933-160">Especificación del lenguaje C#</span><span class="sxs-lookup"><span data-stu-id="b5933-160">C# language specification</span></span>

<span data-ttu-id="b5933-161">Para más información, consulte las propuestas siguientes de la [especificación del lenguaje C#](~/_csharplang/spec/introduction.md):</span><span class="sxs-lookup"><span data-stu-id="b5933-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="b5933-162">Tipos de referencia que aceptan valores null</span><span class="sxs-lookup"><span data-stu-id="b5933-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="b5933-163">Borrador de especificación de tipos de referencia que aceptan valores NULL</span><span class="sxs-lookup"><span data-stu-id="b5933-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-9.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="b5933-164">Vea también</span><span class="sxs-lookup"><span data-stu-id="b5933-164">See also</span></span>

- [<span data-ttu-id="b5933-165">Referencia de C#</span><span class="sxs-lookup"><span data-stu-id="b5933-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="b5933-166">Tipos de valores que aceptan valores NULL</span><span class="sxs-lookup"><span data-stu-id="b5933-166">Nullable value types</span></span>](nullable-value-types.md)
